
> temp-app@0.1.0 lint
> eslint --format json

[{"filePath":"D:\\gemini antigravity works\\Construction app\\eslint.config.mjs","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\gemini antigravity works\\Construction app\\next.config.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\gemini antigravity works\\Construction app\\postcss.config.mjs","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\gemini antigravity works\\Construction app\\src\\actions\\agreement.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":53,"column":23,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":53,"endColumn":26,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1371,1374],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1371,1374],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use server\";\r\n\r\nimport { prisma } from \"@/lib/prisma\";\r\nimport { revalidatePath } from \"next/cache\";\r\n\r\nexport async function getAgreements(projectId?: number) {\r\n    return await prisma.agreement.findMany({\r\n        where: projectId ? { projectId } : undefined,\r\n        include: {\r\n            project: {\r\n                include: {\r\n                    customer: true\r\n                }\r\n            },\r\n            _count: {\r\n                select: { documents: true }\r\n            }\r\n        },\r\n        orderBy: { createdAt: \"desc\" },\r\n    });\r\n}\r\n\r\nexport async function getAgreementById(id: number) {\r\n    return await prisma.agreement.findUnique({\r\n        where: { id },\r\n        include: {\r\n            project: true,\r\n            documents: true,\r\n        },\r\n    });\r\n}\r\n\r\nexport async function createAgreement(data: {\r\n    title: string;\r\n    agreementNumber: string;\r\n    value: number;\r\n    paymentTerms?: string;\r\n    projectId: number;\r\n    startDate?: Date;\r\n    endDate?: Date;\r\n}) {\r\n    const agreement = await prisma.agreement.create({\r\n        data,\r\n    });\r\n    revalidatePath(\"/agreements\");\r\n    revalidatePath(`/projects/${data.projectId}`);\r\n    return agreement;\r\n}\r\n\r\nexport async function updateAgreement(id: number, data: unknown) {\r\n    const agreement = await prisma.agreement.update({\r\n        where: { id },\r\n        data: data as any,\r\n    });\r\n    revalidatePath(\"/agreements\");\r\n    revalidatePath(`/projects/${agreement.projectId}`);\r\n    return agreement;\r\n}\r\n\r\nexport async function deleteAgreement(id: number, projectId: number) {\r\n    await prisma.agreement.delete({\r\n        where: { id },\r\n    });\r\n    revalidatePath(\"/agreements\");\r\n    revalidatePath(`/projects/${projectId}`);\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\gemini antigravity works\\Construction app\\src\\actions\\auth.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\gemini antigravity works\\Construction app\\src\\actions\\bill.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":65,"column":36,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":65,"endColumn":39,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2408,2411],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2408,2411],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":84,"column":27,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":84,"endColumn":30,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2993,2996],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2993,2996],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use server\";\r\n\r\nimport { prisma } from \"@/lib/prisma\";\r\nimport { revalidatePath } from \"next/cache\";\r\nimport { uploadImage } from \"./upload\";\r\n\r\nexport async function createBill(formData: FormData) {\r\n    try {\r\n        const projectId = parseInt(formData.get(\"projectId\") as string);\r\n        const description = formData.get(\"description\") as string;\r\n        const amount = parseFloat(formData.get(\"amount\") as string);\r\n        const billDate = new Date(formData.get(\"billDate\") as string);\r\n        const invoiceNumber = (formData.get(\"invoiceNumber\") as string) || null;\r\n\r\n        let fileUrl = null;\r\n        const file = formData.get(\"file\") as File;\r\n        if (file && file.size > 0) {\r\n            const uploadResult = await uploadImage(formData);\r\n            if (uploadResult.error) {\r\n                return { success: false, error: uploadResult.error };\r\n            }\r\n            fileUrl = uploadResult.url;\r\n        }\r\n\r\n        const bill = await prisma.bill.create({\r\n            data: {\r\n                description,\r\n                amount,\r\n                billDate,\r\n                invoiceNumber,\r\n                fileUrl,\r\n                projectId\r\n            }\r\n        });\r\n\r\n        revalidatePath(`/projects/${projectId}`);\r\n        return { success: true, message: \"Bill created successfully\", bill };\r\n    } catch (error) {\r\n        console.error(\"Create Bill Error:\", error);\r\n        return { success: false, error: (error as Error).message || \"Failed to create bill\" };\r\n    }\r\n}\r\n\r\nexport async function getBills(projectId: number) {\r\n    try {\r\n        const bills = await prisma.bill.findMany({\r\n            where: { projectId },\r\n            orderBy: { billDate: 'desc' }\r\n        });\r\n        return { success: true, bills };\r\n    } catch (error) {\r\n        console.error(\"Get Bills Error:\", error);\r\n        return { success: false, error: \"Failed to fetch bills\" };\r\n    }\r\n}\r\n\r\nexport async function updateBill(id: number, formData: FormData) {\r\n    try {\r\n        const projectId = parseInt(formData.get(\"projectId\") as string);\r\n        const description = formData.get(\"description\") as string;\r\n        const amount = parseFloat(formData.get(\"amount\") as string);\r\n        const billDate = new Date(formData.get(\"billDate\") as string);\r\n        const invoiceNumber = (formData.get(\"invoiceNumber\") as string) || null;\r\n\r\n        const data: Record<string, any> = {\r\n            description,\r\n            amount,\r\n            billDate,\r\n            invoiceNumber,\r\n            projectId\r\n        };\r\n\r\n        const file = formData.get(\"file\") as File;\r\n        if (file && file.size > 0) {\r\n            const uploadResult = await uploadImage(formData);\r\n            if (uploadResult.error) {\r\n                return { success: false, error: uploadResult.error };\r\n            }\r\n            data.fileUrl = uploadResult.url;\r\n        }\r\n\r\n        const bill = await prisma.bill.update({\r\n            where: { id },\r\n            data: data as any\r\n        });\r\n\r\n        revalidatePath(`/projects/${projectId}`);\r\n        return { success: true, message: \"Bill updated successfully\", bill };\r\n    } catch (error) {\r\n        console.error(\"Update Bill Error:\", error);\r\n        return { success: false, error: (error as Error).message || \"Failed to update bill\" };\r\n    }\r\n}\r\n\r\nexport async function deleteBill(id: number, projectId: number) {\r\n    try {\r\n        await prisma.bill.delete({\r\n            where: { id }\r\n        });\r\n        revalidatePath(`/projects/${projectId}`);\r\n        return { success: true, message: \"Bill deleted successfully\" };\r\n    } catch (error) {\r\n        console.error(\"Delete Bill Error:\", error);\r\n        return { success: false, error: \"Failed to delete bill\" };\r\n    }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\gemini antigravity works\\Construction app\\src\\actions\\billbook.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\gemini antigravity works\\Construction app\\src\\actions\\company-document.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\gemini antigravity works\\Construction app\\src\\actions\\company-image.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\gemini antigravity works\\Construction app\\src\\actions\\customer.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\gemini antigravity works\\Construction app\\src\\actions\\document.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\gemini antigravity works\\Construction app\\src\\actions\\payment.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\gemini antigravity works\\Construction app\\src\\actions\\project.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":40,"column":36,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":40,"endColumn":39,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1023,1026],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1023,1026],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":56,"column":27,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":56,"endColumn":30,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1777,1780],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1777,1780],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":68,"column":36,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":68,"endColumn":39,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2173,2176],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2173,2176],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":85,"column":27,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":85,"endColumn":30,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2955,2958],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2955,2958],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use server\";\r\n\r\nimport { prisma } from \"@/lib/prisma\";\r\nimport { revalidatePath } from \"next/cache\";\r\n\r\nexport async function getProjects() {\r\n    return await prisma.project.findMany({\r\n        include: {\r\n            customer: true,\r\n            _count: {\r\n                select: { agreements: true, documents: true, workers: true },\r\n            },\r\n        },\r\n        orderBy: { createdAt: \"desc\" },\r\n    });\r\n}\r\n\r\nexport async function getProjectById(id: number) {\r\n    return await prisma.project.findUnique({\r\n        where: { id },\r\n        include: {\r\n            customer: true,\r\n            documents: true,\r\n            agreements: true,\r\n            workers: true,\r\n            payments: {\r\n                include: {\r\n                    documents: true,\r\n                }\r\n            },\r\n            workOrders: true,\r\n            images: true,\r\n            bills: true,\r\n        },\r\n    });\r\n}\r\n\r\nexport async function createProject(formData: FormData) {\r\n    try {\r\n        const data: Record<string, any> = {\r\n            name: formData.get(\"name\") as string,\r\n            location: (formData.get(\"location\") as string) || null,\r\n            area: (formData.get(\"area\") as string) || null,\r\n            type: formData.get(\"type\") as string,\r\n            status: formData.get(\"status\") as string,\r\n            customerId: parseInt(formData.get(\"customerId\") as string),\r\n            imageUrl: (formData.get(\"imageUrl\") as string) || null,\r\n        };\r\n\r\n        const start = formData.get(\"startDate\") as string;\r\n        const end = formData.get(\"endDate\") as string;\r\n        if (start) data.startDate = new Date(start);\r\n        if (end) data.endDate = new Date(end);\r\n\r\n        const project = await prisma.project.create({\r\n            data: data as any,\r\n        });\r\n        revalidatePath(\"/projects\");\r\n        return { success: true, message: \"Project created successfully\", project };\r\n    } catch (error) {\r\n        console.error(error);\r\n        return { success: false, error: \"Failed to create project\" };\r\n    }\r\n}\r\n\r\nexport async function updateProject(id: number, formData: FormData) {\r\n    try {\r\n        const data: Record<string, any> = {\r\n            name: formData.get(\"name\") as string,\r\n            location: (formData.get(\"location\") as string) || null,\r\n            area: (formData.get(\"area\") as string) || null,\r\n            type: formData.get(\"type\") as string,\r\n            status: formData.get(\"status\") as string,\r\n            customerId: parseInt(formData.get(\"customerId\") as string),\r\n            imageUrl: (formData.get(\"imageUrl\") as string) || null,\r\n        };\r\n\r\n        const start = formData.get(\"startDate\") as string;\r\n        const end = formData.get(\"endDate\") as string;\r\n        if (start) data.startDate = new Date(start);\r\n        if (end) data.endDate = new Date(end);\r\n\r\n        const project = await prisma.project.update({\r\n            where: { id },\r\n            data: data as any,\r\n        });\r\n        revalidatePath(\"/projects\");\r\n        revalidatePath(`/projects/${id}`);\r\n        return { success: true, message: \"Project updated successfully\", project };\r\n    } catch (error) {\r\n        console.error(error);\r\n        return { success: false, error: \"Failed to update project\" };\r\n    }\r\n}\r\n\r\n// ... existing imports\r\n\r\nexport async function addProjectImage(projectId: number, url: string) {\r\n    try {\r\n        const image = await prisma.projectImage.create({\r\n            data: {\r\n                projectId,\r\n                url,\r\n            },\r\n        });\r\n        revalidatePath(`/projects/${projectId}`);\r\n        return { success: true, image };\r\n    } catch (error) {\r\n        console.error(error);\r\n        return { success: false, error: \"Failed to add image\" };\r\n    }\r\n}\r\n\r\nexport async function deleteProjectImage(id: number) {\r\n    try {\r\n        const image = await prisma.projectImage.delete({\r\n            where: { id },\r\n        });\r\n        revalidatePath(`/projects/${image.projectId}`);\r\n        return { success: true };\r\n    } catch (error) {\r\n        console.error(error);\r\n        return { success: false, error: \"Failed to delete image\" };\r\n    }\r\n}\r\n\r\nexport async function deleteProject(id: number) {\r\n    await prisma.project.delete({\r\n        where: { id },\r\n    });\r\n    revalidatePath(\"/projects\");\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\gemini antigravity works\\Construction app\\src\\actions\\upload.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\gemini antigravity works\\Construction app\\src\\actions\\user.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\gemini antigravity works\\Construction app\\src\\actions\\worker.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\gemini antigravity works\\Construction app\\src\\app\\agreements\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":63,"column":118,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":63,"endColumn":121,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3628,3631],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3628,3631],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { getAgreements } from \"@/actions/agreement\";\r\nimport { getProjects } from \"@/actions/project\"; // To pre-fill project list if needed in filter, or for dialog\r\nimport { AgreementDialog } from \"@/components/agreement-dialog\";\r\nimport { AgreementDeleteButton } from \"@/components/agreement-delete-button\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport {\r\n    Table,\r\n    TableBody,\r\n    TableCell,\r\n    TableHead,\r\n    TableHeader,\r\n    TableRow,\r\n} from \"@/components/ui/table\";\r\n\r\nimport { Edit } from \"lucide-react\";\r\n\r\nimport Link from \"next/link\";\r\n\r\nexport default async function AgreementsPage() {\r\n    const agreements = await getAgreements();\r\n    const projects = await getProjects(); // For the dialog dropdown\r\n\r\n    return (\r\n        <div className=\"p-8 space-y-6 max-w-7xl mx-auto\">\r\n            <div className=\"flex justify-between items-center\">\r\n                <div>\r\n                    <h1 className=\"text-3xl font-bold tracking-tight\">Agreements</h1>\r\n                    <p className=\"text-zinc-500 dark:text-zinc-400 mt-2\">Manage contracts and agreements across all projects.</p>\r\n                </div>\r\n                <AgreementDialog projects={projects as unknown as { id: number; name: string }[]} />\r\n            </div>\r\n\r\n            <div className=\"bg-white dark:bg-zinc-900 rounded-lg shadow-sm border border-zinc-200 dark:border-zinc-800 overflow-hidden\">\r\n                <div className=\"overflow-x-auto\">\r\n                    <Table>\r\n                        <TableHeader>\r\n                            <TableRow className=\"bg-zinc-50 dark:bg-zinc-900/50\">\r\n                                <TableHead>Agreement No</TableHead>\r\n                                <TableHead>Title</TableHead>\r\n                                <TableHead>Project</TableHead>\r\n                                <TableHead>Value</TableHead>\r\n                                <TableHead>Dates</TableHead>\r\n                                <TableHead className=\"w-[100px] text-right\">Actions</TableHead>\r\n                            </TableRow>\r\n                        </TableHeader>\r\n                        <TableBody>\r\n                            {agreements.map((agreement) => (\r\n                                <TableRow key={agreement.id}>\r\n                                    <TableCell className=\"font-medium\">{agreement.agreementNumber}</TableCell>\r\n                                    <TableCell>{agreement.title}</TableCell>\r\n                                    <TableCell>\r\n                                        <Link href={`/projects/${agreement.projectId}`} className=\"hover:underline text-blue-600\">\r\n                                            {agreement.project.name}\r\n                                        </Link>\r\n                                    </TableCell>\r\n                                    <TableCell>{new Intl.NumberFormat('en-IN', { style: 'currency', currency: 'INR' }).format(agreement.value)}</TableCell>\r\n                                    <TableCell className=\"text-zinc-500 text-sm\">\r\n                                        {agreement.startDate ? new Date(agreement.startDate).toLocaleDateString() : 'N/A'} -\r\n                                        {agreement.endDate ? new Date(agreement.endDate).toLocaleDateString() : 'N/A'}\r\n                                    </TableCell>\r\n                                    <TableCell className=\"text-right\">\r\n                                        <div className=\"flex items-center justify-end gap-2\">\r\n                                            <AgreementDialog mode=\"edit\" agreement={agreement} projects={projects as any[]} trigger={\r\n                                                <Button variant=\"ghost\" size=\"icon\" className=\"h-8 w-8\">\r\n                                                    <Edit className=\"h-4 w-4\" />\r\n                                                </Button>\r\n                                            } />\r\n                                            <AgreementDeleteButton id={agreement.id} projectId={agreement.projectId} />\r\n                                        </div>\r\n                                    </TableCell>\r\n                                </TableRow>\r\n                            ))}\r\n                            {agreements.length === 0 && (\r\n                                <TableRow>\r\n                                    <TableCell colSpan={6} className=\"text-center py-10 text-zinc-500\">\r\n                                        No agreements found. Click &quot;Add Agreement&quot; to create one.\r\n                                    </TableCell>\r\n                                </TableRow>\r\n                            )}\r\n                        </TableBody>\r\n                    </Table>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\gemini antigravity works\\Construction app\\src\\app\\bill-book\\[id]\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\gemini antigravity works\\Construction app\\src\\app\\bill-book\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":47,"column":39,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":47,"endColumn":42,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2697,2700],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2697,2700],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { getLedgers } from \"@/actions/billbook\";\r\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\r\nimport { Users, Briefcase, UserSquare, Building2 } from \"lucide-react\";\r\nimport Link from \"next/link\";\r\nimport { CreateLedgerDialog } from \"@/components/bill-book/create-ledger-dialog\";\r\n\r\nexport default async function BillBookPage() {\r\n    const ledgers = await getLedgers();\r\n\r\n    const totalReceivable = ledgers.reduce((acc: number, l: { balance: number }) => l.balance > 0 ? acc + l.balance : acc, 0);\r\n    const totalPayable = ledgers.reduce((acc: number, l: { balance: number }) => l.balance < 0 ? acc + Math.abs(l.balance) : acc, 0);\r\n\r\n    return (\r\n        <div className=\"p-8 space-y-6 max-w-7xl mx-auto\">\r\n            <div className=\"flex justify-between items-center\">\r\n                <div>\r\n                    <h1 className=\"text-3xl font-bold tracking-tight\">Bill Book</h1>\r\n                    <p className=\"text-zinc-500 mt-2\">Manage all your ledgers, credits, and debits.</p>\r\n                </div>\r\n                <CreateLedgerDialog />\r\n            </div>\r\n\r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n                <Card className=\"bg-green-50 border-green-200 dark:bg-green-900/20 dark:border-green-800\">\r\n                    <CardHeader className=\"pb-2\">\r\n                        <CardTitle className=\"text-sm font-medium text-green-600 dark:text-green-400\">Total Receivable (You&apos;ll Get)</CardTitle>\r\n                    </CardHeader>\r\n                    <CardContent>\r\n                        <div className=\"text-3xl font-bold text-green-700 dark:text-green-300\">\r\n                            {new Intl.NumberFormat('en-IN', { style: 'currency', currency: 'INR' }).format(totalReceivable)}\r\n                        </div>\r\n                    </CardContent>\r\n                </Card>\r\n                <Card className=\"bg-red-50 border-red-200 dark:bg-red-900/20 dark:border-red-800\">\r\n                    <CardHeader className=\"pb-2\">\r\n                        <CardTitle className=\"text-sm font-medium text-red-600 dark:text-red-400\">Total Payable (You&apos;ll Give)</CardTitle>\r\n                    </CardHeader>\r\n                    <CardContent>\r\n                        <div className=\"text-3xl font-bold text-red-700 dark:text-red-300\">\r\n                            {new Intl.NumberFormat('en-IN', { style: 'currency', currency: 'INR' }).format(totalPayable)}\r\n                        </div>\r\n                    </CardContent>\r\n                </Card>\r\n            </div>\r\n\r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\r\n                {ledgers.map((ledger: any) => (\r\n                    <Link key={ledger.id} href={`/bill-book/${ledger.id}`}>\r\n                        <Card className=\"hover:shadow-md transition-shadow cursor-pointer\">\r\n                            <CardContent className=\"p-6 flex items-center justify-between\">\r\n                                <div className=\"flex items-center gap-4\">\r\n                                    <div className={`p-3 rounded-full ${ledger.type === 'CUSTOMER' ? 'bg-blue-100 text-blue-600' :\r\n                                        ledger.type === 'WORKER' ? 'bg-orange-100 text-orange-600' :\r\n                                            ledger.type === 'VENDOR' ? 'bg-purple-100 text-purple-600' :\r\n                                                'bg-zinc-100 text-zinc-600'\r\n                                        }`}>\r\n                                        {ledger.type === 'CUSTOMER' && <Users className=\"h-5 w-5\" />}\r\n                                        {ledger.type === 'WORKER' && <UserSquare className=\"h-5 w-5\" />}\r\n                                        {ledger.type === 'VENDOR' && <Briefcase className=\"h-5 w-5\" />}\r\n                                        {ledger.type === 'PROJECT' && <Building2 className=\"h-5 w-5\" />}\r\n                                    </div>\r\n                                    <div>\r\n                                        <h3 className=\"font-semibold text-lg\">{ledger.name}</h3>\r\n                                        <p className=\"text-xs text-zinc-500 capitalize\">{ledger.type.toLowerCase()}</p>\r\n                                    </div>\r\n                                </div>\r\n                                <div className=\"text-right\">\r\n                                    <div className={`font-bold ${ledger.balance > 0 ? 'text-green-600' : ledger.balance < 0 ? 'text-red-600' : 'text-zinc-500'}`}>\r\n                                        {new Intl.NumberFormat('en-IN', { style: 'currency', currency: 'INR' }).format(Math.abs(ledger.balance))}\r\n                                    </div>\r\n                                    <div className=\"text-xs text-zinc-400\">\r\n                                        {ledger.balance > 0 ? \"You'll Get\" : ledger.balance < 0 ? \"You'll Give\" : \"Settled\"}\r\n                                    </div>\r\n                                </div>\r\n                            </CardContent>\r\n                        </Card>\r\n                    </Link>\r\n                ))}\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\gemini antigravity works\\Construction app\\src\\app\\customers\\[id]\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\gemini antigravity works\\Construction app\\src\\app\\customers\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\gemini antigravity works\\Construction app\\src\\app\\layout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\gemini antigravity works\\Construction app\\src\\app\\login\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\gemini antigravity works\\Construction app\\src\\app\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\gemini antigravity works\\Construction app\\src\\app\\payments\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\gemini antigravity works\\Construction app\\src\\app\\profile\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\gemini antigravity works\\Construction app\\src\\app\\projects\\[id]\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":294,"column":85,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":294,"endColumn":88,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[17970,17973],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[17970,17973],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { getProjectById } from \"@/actions/project\";\r\nimport { getCustomers } from \"@/actions/customer\";\r\nimport { notFound } from \"next/navigation\";\r\nimport Image from \"next/image\";\r\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\r\nimport { ProjectDialog } from \"@/components/project-dialog\";\r\nimport { DocumentUploader } from \"@/components/document-uploader\";\r\nimport { AgreementDialog } from \"@/components/agreement-dialog\";\r\nimport { AgreementDeleteButton } from \"@/components/agreement-delete-button\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { FileText, Download, Calendar, MapPin, Edit } from \"lucide-react\";\r\nimport { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from \"@/components/ui/table\";\r\n\r\nimport { ProjectWorkerManager } from \"@/components/project-worker-manager\";\r\nimport { getWorkers } from \"@/actions/worker\";\r\n\r\nimport { PaymentDialog } from \"@/components/payment-dialog\";\r\nimport { PaymentDeleteButton } from \"@/components/payment-delete-button\";\r\nimport { ProjectGallery } from \"@/components/project-gallery\";\r\nimport { DocumentDeleteButton } from \"@/components/document-delete-button\";\r\nimport { BillDialog } from \"@/components/bill-dialog\";\r\nimport { BillDeleteButton } from \"@/components/bill-delete-button\";\r\n\r\n\r\nimport { Prisma, Document, Agreement } from \"@prisma/client\";\r\n\r\ntype ProjectWithRelations = Prisma.ProjectGetPayload<{\r\n    include: {\r\n        customer: true;\r\n        documents: true;\r\n        agreements: true;\r\n        workers: true;\r\n        payments: {\r\n            include: {\r\n                documents: true;\r\n            }\r\n        };\r\n        workOrders: true; // Added workOrders just in case\r\n        images: true;\r\n        bills: true;\r\n    }\r\n}>;\r\n\r\nexport default async function ProjectDetailPage({ params }: { params: Promise<{ id: string }> }) {\r\n    const resolvedParams = await params;\r\n    const id = parseInt(resolvedParams.id);\r\n    const project = await getProjectById(id) as ProjectWithRelations | null;\r\n    const customers = await getCustomers();\r\n    const allWorkers = await getWorkers();\r\n\r\n    if (!project) notFound();\r\n\r\n    return (\r\n        <div className=\"p-8 space-y-6 max-w-7xl mx-auto\">\r\n\r\n            <div className=\"flex flex-col md:flex-row justify-between items-start md:items-center gap-4\">\r\n                <div className=\"flex items-start gap-4\">\r\n                    {project.imageUrl && (\r\n                        <div className=\"relative h-24 w-40 rounded-lg overflow-hidden border border-zinc-200 dark:border-zinc-800 shadow-sm\">\r\n                            <Image\r\n                                src={project.imageUrl}\r\n                                alt={project.name}\r\n                                fill\r\n                                className=\"object-cover\"\r\n                            />\r\n                        </div>\r\n                    )}\r\n                    <div>\r\n                        <div className=\"flex items-center gap-2 mb-1\">\r\n                            <span className={`inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-medium ${project.status === 'Completed' ? 'bg-green-100 text-green-800' :\r\n                                project.status === 'Ongoing' ? 'bg-blue-100 text-blue-800' :\r\n                                    'bg-zinc-100 text-zinc-800'\r\n                                }`}>\r\n                                {project.status}\r\n                            </span>\r\n                            <span className=\"text-zinc-400 text-sm\">{project.type}</span>\r\n                        </div>\r\n                        <h1 className=\"text-3xl font-bold\">{project.name}</h1>\r\n                        <div className=\"flex items-center gap-4 mt-2 text-zinc-500 text-sm\">\r\n                            <div className=\"flex items-center gap-1\">\r\n                                <span className=\"font-medium text-zinc-900 dark:text-zinc-100\">Customer:</span> {project.customer.name}\r\n                            </div>\r\n                            {project.location && (\r\n                                <div className=\"flex items-center gap-1\">\r\n                                    <MapPin className=\"h-3.5 w-3.5\" /> {project.location}\r\n                                </div>\r\n                            )}\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n                <ProjectDialog\r\n                    mode=\"edit\"\r\n                    project={{\r\n                        id: project.id,\r\n                        name: project.name,\r\n                        location: project.location,\r\n                        area: project.area,\r\n                        type: project.type,\r\n                        status: project.status,\r\n                        customerId: project.customerId,\r\n                        startDate: project.startDate ? new Date(project.startDate).toISOString() : null,\r\n                        endDate: project.endDate ? new Date(project.endDate).toISOString() : null,\r\n                        imageUrl: project.imageUrl\r\n                    }}\r\n                    customers={customers}\r\n                    trigger={\r\n                        <Button variant=\"outline\">\r\n                            <Edit className=\"mr-2 h-4 w-4\" /> Edit Project\r\n                        </Button>\r\n                    }\r\n                />\r\n            </div>\r\n\r\n            <Tabs defaultValue=\"overview\" className=\"w-full\">\r\n                <TabsList className=\"grid w-full grid-cols-2 md:grid-cols-5 h-auto md:h-10\">\r\n                    <TabsTrigger value=\"overview\">Overview</TabsTrigger>\r\n                    <TabsTrigger value=\"documents\">Documents</TabsTrigger>\r\n                    <TabsTrigger value=\"agreements\">Agreements</TabsTrigger>\r\n                    <TabsTrigger value=\"workers\">Workers</TabsTrigger>\r\n                    <TabsTrigger value=\"payments\">Payments</TabsTrigger>\r\n                    <TabsTrigger value=\"bills\">Bills</TabsTrigger>\r\n                    <TabsTrigger value=\"gallery\">Gallery</TabsTrigger>\r\n                </TabsList>\r\n\r\n                <TabsContent value=\"overview\" className=\"space-y-4 mt-6\">\r\n                    <Card>\r\n                        <CardHeader>\r\n                            <CardTitle>Project Details</CardTitle>\r\n                        </CardHeader>\r\n                        <CardContent>\r\n                            <dl className=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\r\n                                <div>\r\n                                    <dt className=\"text-sm font-medium text-zinc-500\">Area</dt>\r\n                                    <dd className=\"text-lg font-semibold\">{project.area || \"N/A\"}</dd>\r\n                                </div>\r\n                                <div>\r\n                                    <dt className=\"text-sm font-medium text-zinc-500\">Start Date</dt>\r\n                                    <dd className=\"text-lg font-semibold flex items-center gap-2\">\r\n                                        <Calendar className=\"h-4 w-4 text-zinc-400\" />\r\n                                        {project.startDate ? new Date(project.startDate).toLocaleDateString() : \"N/A\"}\r\n                                    </dd>\r\n                                </div>\r\n                                <div>\r\n                                    <dt className=\"text-sm font-medium text-zinc-500\">End Date</dt>\r\n                                    <dd className=\"text-lg font-semibold flex items-center gap-2\">\r\n                                        <Calendar className=\"h-4 w-4 text-zinc-400\" />\r\n                                        {project.endDate ? new Date(project.endDate).toLocaleDateString() : \"N/A\"}\r\n                                    </dd>\r\n                                </div>\r\n                            </dl>\r\n                        </CardContent>\r\n                    </Card>\r\n\r\n                    <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n                        {/* Quick Stats or Activity Log could go here */}\r\n                    </div>\r\n                </TabsContent>\r\n\r\n                <TabsContent value=\"documents\" className=\"space-y-6 mt-6\">\r\n                    <div className=\"flex flex-col gap-4\">\r\n                        {/* Document Uploader */}\r\n                        <DocumentUploader projectId={project.id} />\r\n\r\n                        <h3 className=\"text-lg font-semibold mt-4\">Uploaded Documents</h3>\r\n                        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\r\n                            {project.documents.map((doc: Document) => (\r\n                                <Card key={doc.id} className=\"group relative\">\r\n                                    <CardHeader className=\"flex flex-row items-start justify-between space-y-0 pb-2\">\r\n                                        <div className=\"space-y-1\">\r\n                                            <CardTitle className=\"text-base font-medium truncate w-[200px]\" title={doc.name}>\r\n                                                {doc.name}\r\n                                            </CardTitle>\r\n                                            <p className=\"text-xs text-zinc-500\">{doc.type}</p>\r\n                                        </div>\r\n                                        <div className=\"bg-zinc-100 dark:bg-zinc-800 p-2 rounded-md\">\r\n                                            <FileText className=\"h-5 w-5 text-zinc-500\" />\r\n                                        </div>\r\n                                    </CardHeader>\r\n                                    <CardContent>\r\n                                        <div className=\"flex items-center justify-between mt-4\">\r\n                                            <div className=\"text-xs text-zinc-400\">\r\n                                                {new Date(doc.uploadedAt).toLocaleDateString()}\r\n                                            </div>\r\n                                            <div className=\"flex gap-2\">\r\n                                                <Button variant=\"outline\" size=\"sm\" asChild>\r\n                                                    <a href={doc.path} target=\"_blank\" download>\r\n                                                        <Download className=\"mr-2 h-3 w-3\" /> Download\r\n                                                    </a>\r\n                                                </Button>\r\n                                                <DocumentDeleteButton id={doc.id} projectId={project.id} />\r\n                                            </div>\r\n                                        </div>\r\n                                    </CardContent>\r\n                                </Card>\r\n                            ))}\r\n                            {project.documents.length === 0 && (\r\n                                <div className=\"col-span-full border-2 border-dashed rounded-lg p-10 text-center text-zinc-500\">\r\n                                    <FileText className=\"h-10 w-10 mx-auto text-zinc-300 mb-2\" />\r\n                                    <p>No documents uploaded yet.</p>\r\n                                    <p className=\"text-xs\">Use the uploader above to add plans, agreements, etc.</p>\r\n                                </div>\r\n                            )}\r\n                        </div>\r\n                    </div>\r\n                </TabsContent>\r\n\r\n                <TabsContent value=\"agreements\" className=\"space-y-6 mt-6\">\r\n                    <div className=\"flex justify-end\">\r\n                        <AgreementDialog projectId={project.id} />\r\n                    </div>\r\n                    <div className=\"bg-white dark:bg-zinc-900 rounded-lg shadow-sm border border-zinc-200 dark:border-zinc-800 overflow-hidden\">\r\n                        <div className=\"overflow-x-auto\">\r\n                            <Table>\r\n                                <TableHeader>\r\n                                    <TableRow className=\"bg-zinc-50 dark:bg-zinc-900/50\">\r\n                                        <TableHead>Agreement No</TableHead>\r\n                                        <TableHead>Title</TableHead>\r\n                                        <TableHead>Value</TableHead>\r\n                                        <TableHead>Dates</TableHead>\r\n                                        <TableHead className=\"w-[100px] text-right\">Actions</TableHead>\r\n                                    </TableRow>\r\n                                </TableHeader>\r\n                                <TableBody>\r\n                                    {project.agreements.map((agreement: Agreement) => (\r\n                                        <TableRow key={agreement.id}>\r\n                                            <TableCell className=\"font-medium\">{agreement.agreementNumber}</TableCell>\r\n                                            <TableCell>{agreement.title}</TableCell>\r\n                                            <TableCell>{new Intl.NumberFormat('en-IN', { style: 'currency', currency: 'INR' }).format(agreement.value)}</TableCell>\r\n                                            <TableCell className=\"text-zinc-500 text-sm\">\r\n                                                {agreement.startDate ? new Date(agreement.startDate).toLocaleDateString() : 'N/A'} -\r\n                                                {agreement.endDate ? new Date(agreement.endDate).toLocaleDateString() : 'N/A'}\r\n                                            </TableCell>\r\n                                            <TableCell className=\"text-right\">\r\n                                                <div className=\"flex items-center justify-end gap-2\">\r\n                                                    <AgreementDialog mode=\"edit\" agreement={agreement} projectId={project.id} trigger={\r\n                                                        <Button variant=\"ghost\" size=\"icon\" className=\"h-8 w-8\">\r\n                                                            <Edit className=\"h-4 w-4\" />\r\n                                                        </Button>\r\n                                                    } />\r\n                                                    <AgreementDeleteButton id={agreement.id} projectId={project.id} />\r\n                                                </div>\r\n                                            </TableCell>\r\n                                        </TableRow>\r\n                                    ))}\r\n                                    {project.agreements.length === 0 && (\r\n                                        <TableRow>\r\n                                            <TableCell colSpan={5} className=\"text-center py-10 text-zinc-500\">\r\n                                                No agreements found. Click &quot;Add Agreement&quot; to create one.\r\n                                            </TableCell>\r\n                                        </TableRow>\r\n                                    )}\r\n                                </TableBody>\r\n                            </Table>\r\n                        </div>\r\n                    </div>\r\n                </TabsContent>\r\n                <TabsContent value=\"workers\" className=\"mt-6\">\r\n                    <ProjectWorkerManager\r\n                        projectId={project.id}\r\n                        assignedWorkers={project.workers}\r\n                        allWorkers={allWorkers}\r\n                    />\r\n                </TabsContent>\r\n                <TabsContent value=\"payments\" className=\"space-y-6 mt-6\">\r\n                    <div className=\"flex justify-end\">\r\n                        <PaymentDialog projectId={project.id} />\r\n                    </div>\r\n                    <div className=\"bg-white dark:bg-zinc-900 rounded-lg shadow-sm border border-zinc-200 dark:border-zinc-800 overflow-hidden\">\r\n                        <div className=\"overflow-x-auto\">\r\n                            <Table>\r\n                                <TableHeader>\r\n                                    <TableRow className=\"bg-zinc-50 dark:bg-zinc-900/50\">\r\n                                        <TableHead>Date</TableHead>\r\n                                        <TableHead>Amount</TableHead>\r\n                                        <TableHead>Mode</TableHead>\r\n                                        <TableHead>Reference</TableHead>\r\n                                        <TableHead>Bills</TableHead>\r\n                                        <TableHead className=\"w-[100px] text-right\">Actions</TableHead>\r\n                                    </TableRow>\r\n                                </TableHeader>\r\n                                <TableBody>\r\n                                    {project.payments.map((payment) => (\r\n                                        <TableRow key={payment.id}>\r\n                                            <TableCell className=\"font-medium text-zinc-500\">\r\n                                                {new Date(payment.date).toLocaleDateString()}\r\n                                            </TableCell>\r\n                                            <TableCell className=\"font-semibold\">{new Intl.NumberFormat('en-IN', { style: 'currency', currency: 'INR' }).format(payment.amount)}</TableCell>\r\n                                            <TableCell>{payment.mode}</TableCell>\r\n                                            <TableCell className=\"text-zinc-400 text-sm\">{payment.reference || \"-\"}</TableCell>\r\n                                            <TableCell>\r\n                                                <div className=\"flex flex-col gap-1\">\r\n                                                    {payment.documents && payment.documents.length > 0 ? (\r\n                                                        payment.documents.map((doc: any) => (\r\n                                                            <div key={doc.id} className=\"flex items-center justify-between gap-2 bg-zinc-50 dark:bg-zinc-800/50 p-1 rounded\">\r\n                                                                <a href={doc.path} target=\"_blank\" className=\"text-xs text-blue-500 hover:underline flex items-center gap-1 truncate max-w-[150px]\">\r\n                                                                    <FileText className=\"h-3 w-3\" /> {doc.name}\r\n                                                                </a>\r\n                                                                <DocumentDeleteButton id={doc.id} projectId={project.id} isSmall={true} />\r\n                                                            </div>\r\n                                                        ))\r\n                                                    ) : <span className=\"text-zinc-300 text-xs\">-</span>}\r\n                                                </div>\r\n                                            </TableCell>\r\n                                            <TableCell className=\"text-right\">\r\n                                                <div className=\"flex items-center justify-end gap-2\">\r\n                                                    <PaymentDialog mode=\"edit\" payment={payment} projectId={project.id} trigger={\r\n                                                        <Button variant=\"ghost\" size=\"icon\" className=\"h-8 w-8\">\r\n                                                            <Edit className=\"h-4 w-4\" />\r\n                                                        </Button>\r\n                                                    } />\r\n                                                    <PaymentDeleteButton id={payment.id} projectId={project.id} />\r\n                                                </div>\r\n                                            </TableCell>\r\n                                        </TableRow>\r\n                                    ))}\r\n                                    {project.payments.length === 0 && (\r\n                                        <TableRow>\r\n                                            <TableCell colSpan={6} className=\"text-center py-10 text-zinc-500\">\r\n                                                No payments recorded. Click &quot;Record Payment&quot; to add one.\r\n                                            </TableCell>\r\n                                        </TableRow>\r\n                                    )}\r\n                                </TableBody>\r\n                            </Table>\r\n                        </div>\r\n                    </div>\r\n                </TabsContent >\r\n\r\n                <TabsContent value=\"bills\" className=\"space-y-6 mt-6\">\r\n                    <div className=\"flex justify-end\">\r\n                        <BillDialog projectId={project.id} />\r\n                    </div>\r\n\r\n                    <div className=\"bg-white dark:bg-zinc-900 rounded-lg shadow-sm border border-zinc-200 dark:border-zinc-800 overflow-hidden\">\r\n                        <div className=\"overflow-x-auto\">\r\n                            <Table>\r\n                                <TableHeader>\r\n                                    <TableRow className=\"bg-zinc-50 dark:bg-zinc-900/50\">\r\n                                        <TableHead>Date</TableHead>\r\n                                        <TableHead>Description</TableHead>\r\n                                        <TableHead>Invoice No</TableHead>\r\n                                        <TableHead>Amount</TableHead>\r\n                                        <TableHead>File</TableHead>\r\n                                        <TableHead className=\"w-[100px] text-right\">Actions</TableHead>\r\n                                    </TableRow>\r\n                                </TableHeader>\r\n                                <TableBody>\r\n                                    {project.bills.map((bill) => (\r\n                                        <TableRow key={bill.id}>\r\n                                            <TableCell className=\"font-medium text-zinc-500\">\r\n                                                {new Date(bill.billDate).toLocaleDateString()}\r\n                                            </TableCell>\r\n                                            <TableCell>{bill.description}</TableCell>\r\n                                            <TableCell>{bill.invoiceNumber || \"-\"}</TableCell>\r\n                                            <TableCell className=\"font-semibold\">{new Intl.NumberFormat('en-IN', { style: 'currency', currency: 'INR' }).format(bill.amount)}</TableCell>\r\n                                            <TableCell>\r\n                                                {bill.fileUrl ? (\r\n                                                    <a href={bill.fileUrl} target=\"_blank\" className=\"flex items-center gap-1 text-blue-600 hover:underline\">\r\n                                                        <FileText className=\"h-4 w-4\" /> View\r\n                                                    </a>\r\n                                                ) : \"-\"}\r\n                                            </TableCell>\r\n                                            <TableCell className=\"text-right\">\r\n                                                <div className=\"flex items-center justify-end gap-2\">\r\n                                                    <BillDialog projectId={project.id} bill={bill} mode=\"edit\" trigger={\r\n                                                        <Button variant=\"ghost\" size=\"icon\" className=\"h-8 w-8\">\r\n                                                            <Edit className=\"h-4 w-4\" />\r\n                                                        </Button>\r\n                                                    } />\r\n                                                    <BillDeleteButton id={bill.id} projectId={project.id} />\r\n                                                </div>\r\n                                            </TableCell>\r\n                                        </TableRow>\r\n                                    ))}\r\n                                    {project.bills.length === 0 && (\r\n                                        <TableRow>\r\n                                            <TableCell colSpan={6} className=\"text-center py-10 text-zinc-500\">\r\n                                                No bills added. Click &quot;Add Bill&quot; to create one.\r\n                                            </TableCell>\r\n                                        </TableRow>\r\n                                    )}\r\n                                </TableBody>\r\n                            </Table>\r\n                        </div>\r\n                    </div>\r\n                </TabsContent>\r\n                <TabsContent value=\"gallery\" className=\"space-y-6 mt-6\">\r\n                    <Card>\r\n                        <CardHeader>\r\n                            <CardTitle>Project Gallery</CardTitle>\r\n                            <CardDescription>Photos from the site.</CardDescription>\r\n                        </CardHeader>\r\n                        <CardContent>\r\n                            <ProjectGallery projectId={project.id} images={project.images} />\r\n                        </CardContent>\r\n                    </Card>\r\n                </TabsContent>\r\n            </Tabs >\r\n        </div >\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\gemini antigravity works\\Construction app\\src\\app\\projects\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\gemini antigravity works\\Construction app\\src\\app\\register\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\gemini antigravity works\\Construction app\\src\\app\\workers\\[id]\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\gemini antigravity works\\Construction app\\src\\app\\workers\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\gemini antigravity works\\Construction app\\src\\components\\agreement-delete-button.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\gemini antigravity works\\Construction app\\src\\components\\agreement-dialog.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\gemini antigravity works\\Construction app\\src\\components\\app-sidebar.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\gemini antigravity works\\Construction app\\src\\components\\bill-book\\create-ledger-dialog.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\gemini antigravity works\\Construction app\\src\\components\\bill-book\\entry-dialog.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CalendarIcon' is defined but never used.","line":27,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":27,"endColumn":22},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":56,"column":22,"nodeType":null,"messageId":"unusedVar","endLine":56,"endColumn":27}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useState, useTransition } from \"react\";\r\nimport { addLedgerEntry, TransactionType } from \"@/actions/billbook\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport {\r\n    Dialog,\r\n    DialogContent,\r\n    DialogDescription,\r\n    DialogFooter,\r\n    DialogHeader,\r\n    DialogTitle,\r\n    DialogTrigger,\r\n} from \"@/components/ui/dialog\";\r\nimport { Input } from \"@/components/ui/input\";\r\nimport { Label } from \"@/components/ui/label\";\r\nimport { Textarea } from \"@/components/ui/textarea\";\r\nimport {\r\n    Select,\r\n    SelectContent,\r\n    SelectItem,\r\n    SelectTrigger,\r\n    SelectValue,\r\n} from \"@/components/ui/select\";\r\nimport { toast } from \"sonner\";\r\nimport { useRouter } from \"next/navigation\";\r\nimport { CalendarIcon } from \"lucide-react\";\r\n\r\nexport function AddEntryDialog({ ledgerId, type, trigger }: { ledgerId: number, type: TransactionType, trigger: React.ReactNode }) {\r\n    const [open, setOpen] = useState(false);\r\n    const [amount, setAmount] = useState(\"\");\r\n    const [remarks, setRemarks] = useState(\"\");\r\n    const [mode, setMode] = useState(\"Cash\");\r\n    const [date, setDate] = useState(new Date().toISOString().split('T')[0]);\r\n\r\n    const [isPending, startTransition] = useTransition();\r\n    const router = useRouter();\r\n\r\n    const handleSubmit = () => {\r\n        if (!amount) return;\r\n\r\n        startTransition(async () => {\r\n            try {\r\n                await addLedgerEntry(ledgerId, {\r\n                    amount: parseFloat(amount),\r\n                    type,\r\n                    mode,\r\n                    remarks,\r\n                    date: new Date(date),\r\n                });\r\n                toast.success(\"Entry added\");\r\n                setOpen(false);\r\n                setAmount(\"\");\r\n                setRemarks(\"\");\r\n                router.refresh();\r\n            } catch (error) {\r\n                toast.error(\"Failed to add entry\");\r\n            }\r\n        });\r\n    };\r\n\r\n    return (\r\n        <Dialog open={open} onOpenChange={setOpen}>\r\n            <DialogTrigger asChild>\r\n                {trigger}\r\n            </DialogTrigger>\r\n            <DialogContent>\r\n                <DialogHeader>\r\n                    <DialogTitle className={type === 'DEBIT' ? 'text-green-600' : 'text-red-600'}>\r\n                        {type === 'DEBIT' ? 'You Got (Payment In)' : 'You Gave (Credit Given)'}\r\n                    </DialogTitle>\r\n                    <DialogDescription>\r\n                        Record a {type.toLowerCase()} transaction.\r\n                    </DialogDescription>\r\n                </DialogHeader>\r\n                <div className=\"grid gap-4 py-4\">\r\n                    <div className=\"grid gap-2\">\r\n                        <Label htmlFor=\"amount\">Amount</Label>\r\n                        <Input\r\n                            id=\"amount\"\r\n                            type=\"number\"\r\n                            value={amount}\r\n                            onChange={(e) => setAmount(e.target.value)}\r\n                            placeholder=\"0.00\"\r\n                            className=\"text-lg font-bold\"\r\n                            autoFocus\r\n                        />\r\n                    </div>\r\n                    <div className=\"grid gap-2\">\r\n                        <Label htmlFor=\"date\">Date</Label>\r\n                        <Input\r\n                            id=\"date\"\r\n                            type=\"date\"\r\n                            value={date}\r\n                            onChange={(e) => setDate(e.target.value)}\r\n                        />\r\n                    </div>\r\n                    <div className=\"grid gap-2\">\r\n                        <Label htmlFor=\"remarks\">Remarks</Label>\r\n                        <Textarea\r\n                            id=\"remarks\"\r\n                            value={remarks}\r\n                            onChange={(e) => setRemarks(e.target.value)}\r\n                            placeholder=\"Enter notes...\"\r\n                        />\r\n                    </div>\r\n                    <div className=\"grid gap-2\">\r\n                        <Label htmlFor=\"mode\">Payment Mode</Label>\r\n                        <Select value={mode} onValueChange={setMode}>\r\n                            <SelectTrigger>\r\n                                <SelectValue />\r\n                            </SelectTrigger>\r\n                            <SelectContent>\r\n                                <SelectItem value=\"Cash\">Cash</SelectItem>\r\n                                <SelectItem value=\"Online\">Online / UPI</SelectItem>\r\n                                <SelectItem value=\"Cheque\">Cheque</SelectItem>\r\n                                <SelectItem value=\"Bank Transfer\">Bank Transfer</SelectItem>\r\n                            </SelectContent>\r\n                        </Select>\r\n                    </div>\r\n                </div>\r\n                <DialogFooter>\r\n                    <Button variant=\"outline\" onClick={() => setOpen(false)}>Cancel</Button>\r\n                    <Button\r\n                        onClick={handleSubmit}\r\n                        disabled={isPending}\r\n                        className={type === 'DEBIT' ? 'bg-green-600 hover:bg-green-700' : 'bg-red-600 hover:bg-red-700'}\r\n                    >\r\n                        {isPending ? \"Saving...\" : \"Save\"}\r\n                    </Button>\r\n                </DialogFooter>\r\n            </DialogContent>\r\n        </Dialog>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\gemini antigravity works\\Construction app\\src\\components\\bill-book\\pdf-button.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'dynamic' is defined but never used.","line":7,"column":8,"nodeType":null,"messageId":"unusedVar","endLine":7,"endColumn":15},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":9,"column":64,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":9,"endColumn":67,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[304,307],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[304,307],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":9,"column":78,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":9,"endColumn":81,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[318,321],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[318,321],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { FileDown, Loader2 } from \"lucide-react\";\r\nimport { useState } from \"react\";\r\n// Dynamic import for jspdf to avoid SSR issues\r\nimport dynamic from \"next/dynamic\";\r\n\r\nexport function LedgerPDFButton({ ledger, entries }: { ledger: any, entries: any[] }) {\r\n    const [loading, setLoading] = useState(false);\r\n\r\n    const handleDownload = async () => {\r\n        setLoading(true);\r\n        try {\r\n            const jsPDF = (await import(\"jspdf\")).default;\r\n            const autoTable = (await import(\"jspdf-autotable\")).default;\r\n\r\n            const doc = new jsPDF();\r\n\r\n            // Header\r\n            doc.setFontSize(20);\r\n            doc.text(ledger.name, 14, 20);\r\n            doc.setFontSize(10);\r\n            doc.text(`Type: ${ledger.type}`, 14, 26);\r\n            doc.text(`Generated on: ${new Date().toLocaleDateString()}`, 14, 32);\r\n\r\n            // Balance Summary\r\n            const balance = ledger.balance;\r\n            const status = balance > 0 ? \"You'll Get (Receivable)\" : balance < 0 ? \"You'll Give (Payable)\" : \"Settled\";\r\n            doc.setFontSize(14);\r\n            doc.setTextColor(balance > 0 ? 0 : balance < 0 ? 200 : 100, balance > 0 ? 100 : 0, 0); // Simple Green/Red logic\r\n            doc.text(`Net Balance: ${new Intl.NumberFormat('en-IN', { style: 'currency', currency: 'INR' }).format(Math.abs(balance))} (${status})`, 14, 45);\r\n            doc.setTextColor(0, 0, 0);\r\n\r\n            // Table\r\n            const tableData = entries.map(entry => [\r\n                new Date(entry.date).toLocaleDateString(),\r\n                entry.remarks || \"-\",\r\n                entry.mode,\r\n                entry.type === 'DEBIT' ? `+ ${entry.amount}` : \"\",\r\n                entry.type === 'CREDIT' ? `- ${entry.amount}` : \"\",\r\n            ]);\r\n\r\n            autoTable(doc, {\r\n                startY: 55,\r\n                head: [['Date', 'Remarks', 'Mode', 'You Got (+)', 'You Gave (-)']],\r\n                body: tableData,\r\n                theme: 'grid',\r\n                headStyles: { fillColor: [66, 66, 66] },\r\n                styles: { fontSize: 9 },\r\n                columnStyles: {\r\n                    3: { textColor: [0, 150, 0], fontStyle: 'bold' }, // Green for Debit\r\n                    4: { textColor: [200, 0, 0], fontStyle: 'bold' }, // Red for Credit\r\n                }\r\n            });\r\n\r\n            doc.save(`${ledger.name}_Ledger.pdf`);\r\n        } catch (error) {\r\n            console.error(\"PDF Generation failed:\", error);\r\n            alert(\"Failed to generate PDF\");\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <Button variant=\"outline\" size=\"sm\" onClick={handleDownload} disabled={loading}>\r\n            {loading ? <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" /> : <FileDown className=\"mr-2 h-4 w-4\" />}\r\n            Export PDF\r\n        </Button>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\gemini antigravity works\\Construction app\\src\\components\\bill-book\\transaction-list.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'TransactionType' is defined but never used.","line":4,"column":41,"nodeType":null,"messageId":"unusedVar","endLine":4,"endColumn":56},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'format' is defined but never used.","line":9,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":9,"endColumn":16},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":12,"column":38,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":12,"endColumn":41,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[412,415],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[412,415],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":13,"column":34,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":13,"endColumn":37,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[455,458],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[455,458],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'type' is defined but never used.","line":22,"column":54,"nodeType":null,"messageId":"unusedVar","endLine":22,"endColumn":58},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":22,"column":73,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":22,"endColumn":76,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[748,751],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[748,751],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useTransition } from \"react\";\r\nimport { deleteLedgerEntry, LedgerType, TransactionType } from \"@/actions/billbook\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Trash } from \"lucide-react\";\r\nimport { toast } from \"sonner\";\r\nimport { useRouter } from \"next/navigation\";\r\nimport { format } from \"date-fns\";\r\n\r\n// Group entries by date\r\nfunction groupEntriesByDate(entries: any[]) {\r\n    const groups: Record<string, any[]> = {};\r\n    entries.forEach(entry => {\r\n        const date = new Date(entry.date).toDateString();\r\n        if (!groups[date]) groups[date] = [];\r\n        groups[date].push(entry);\r\n    });\r\n    return groups;\r\n}\r\n\r\nexport function TransactionList({ entries, ledgerId, type }: { entries: any[], ledgerId: number, type: LedgerType }) {\r\n    const [isPending, startTransition] = useTransition();\r\n    const router = useRouter();\r\n\r\n    const handleDelete = (id: number) => {\r\n        if (!confirm(\"Delete this entry?\")) return;\r\n        startTransition(async () => {\r\n            try {\r\n                await deleteLedgerEntry(id, ledgerId);\r\n                toast.success(\"Entry deleted\");\r\n                router.refresh();\r\n            } catch {\r\n                toast.error(\"Failed to delete\");\r\n            }\r\n        });\r\n    };\r\n\r\n    const grouped = groupEntriesByDate(entries);\r\n\r\n    return (\r\n        <div className=\"space-y-6\">\r\n            {Object.entries(grouped).map(([date, dayEntries]) => (\r\n                <div key={date} className=\"space-y-2\">\r\n                    <div className=\"sticky top-0 bg-background/95 backdrop-blur z-10 py-2 border-b text-xs font-semibold text-zinc-500 uppercase tracking-wider\">\r\n                        {date}\r\n                    </div>\r\n                    <div className=\"space-y-2\">\r\n                        {dayEntries.map((entry) => (\r\n                            <div key={entry.id} className=\"bg-white dark:bg-zinc-900 border rounded-lg p-3 flex justify-between items-center shadow-sm\">\r\n                                <div className=\"flex-1\">\r\n                                    <div className=\"flex items-center gap-2\">\r\n                                        <span className={`text-sm font-bold px-2 py-0.5 rounded text-xs ${entry.type === 'DEBIT' ? 'bg-green-100 text-green-700' : 'bg-red-100 text-red-700'\r\n                                            }`}>\r\n                                            {entry.type === 'DEBIT' ? 'YOU GOT' : 'YOU GAVE'}\r\n                                        </span>\r\n                                        <span className=\"text-zinc-500 text-xs bg-zinc-100 dark:bg-zinc-800 px-1.5 py-0.5 rounded\">{entry.mode}</span>\r\n                                    </div>\r\n                                    <p className=\"text-sm mt-1 text-zinc-800 dark:text-zinc-200\">{entry.remarks || \"No remarks\"}</p>\r\n                                </div>\r\n                                <div className=\"flex items-center gap-4\">\r\n                                    <span className={`text-lg font-bold ${entry.type === 'DEBIT' ? 'text-green-600' : 'text-red-500'\r\n                                        }`}>\r\n                                        {entry.type === 'DEBIT' ? '+' : '-'} {new Intl.NumberFormat('en-IN', { style: 'currency', currency: 'INR' }).format(entry.amount)}\r\n                                    </span>\r\n                                    <Button variant=\"ghost\" size=\"icon\" className=\"h-6 w-6 text-zinc-400 hover:text-red-500\" onClick={() => handleDelete(entry.id)} disabled={isPending}>\r\n                                        <Trash className=\"h-3 w-3\" />\r\n                                    </Button>\r\n                                </div>\r\n                            </div>\r\n                        ))}\r\n                    </div>\r\n                </div>\r\n            ))}\r\n            {entries.length === 0 && (\r\n                <div className=\"text-center py-10 text-zinc-500\">\r\n                    No transactions yet.\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\gemini antigravity works\\Construction app\\src\\components\\bill-delete-button.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\gemini antigravity works\\Construction app\\src\\components\\bill-dialog.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Edit' is defined but never used.","line":17,"column":16,"nodeType":null,"messageId":"unusedVar","endLine":17,"endColumn":20},{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nD:\\gemini antigravity works\\Construction app\\src\\components\\bill-dialog.tsx:52:13\n  50 |     useEffect(() => {\n  51 |         if (open && mode === \"edit\" && bill) {\n> 52 |             setFormData({\n     |             ^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  53 |                 description: bill.description,\n  54 |                 amount: String(bill.amount),\n  55 |                 billDate: new Date(bill.billDate).toISOString().split('T')[0],","line":52,"column":13,"nodeType":null,"endLine":52,"endColumn":24},{"ruleId":"@typescript-eslint/ban-ts-comment","severity":2,"message":"Use \"@ts-expect-error\" instead of \"@ts-ignore\", as \"@ts-ignore\" will do nothing if the following line is error-free.","line":80,"column":17,"nodeType":"Line","messageId":"tsIgnoreInsteadOfExpectError","endLine":80,"endColumn":30,"suggestions":[{"messageId":"replaceTsIgnoreWithTsExpectError","fix":{"range":[2616,2629],"text":"// @ts-expect-error"},"desc":"Replace \"@ts-ignore\" with \"@ts-expect-error\"."}]},{"ruleId":"@typescript-eslint/ban-ts-comment","severity":2,"message":"Use \"@ts-expect-error\" instead of \"@ts-ignore\", as \"@ts-ignore\" will do nothing if the following line is error-free.","line":103,"column":25,"nodeType":"Line","messageId":"tsIgnoreInsteadOfExpectError","endLine":103,"endColumn":38,"suggestions":[{"messageId":"replaceTsIgnoreWithTsExpectError","fix":{"range":[3680,3693],"text":"// @ts-expect-error"},"desc":"Replace \"@ts-ignore\" with \"@ts-expect-error\"."}]},{"ruleId":"@typescript-eslint/ban-ts-comment","severity":2,"message":"Use \"@ts-expect-error\" instead of \"@ts-ignore\", as \"@ts-ignore\" will do nothing if the following line is error-free.","line":182,"column":33,"nodeType":"Line","messageId":"tsIgnoreInsteadOfExpectError","endLine":182,"endColumn":46,"suggestions":[{"messageId":"replaceTsIgnoreWithTsExpectError","fix":{"range":[7199,7212],"text":"// @ts-expect-error"},"desc":"Replace \"@ts-ignore\" with \"@ts-expect-error\"."}]}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useTransition, useState, useEffect } from \"react\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport {\r\n    Dialog,\r\n    DialogContent,\r\n    DialogHeader,\r\n    DialogTitle,\r\n    DialogTrigger,\r\n    DialogFooter,\r\n} from \"@/components/ui/dialog\";\r\nimport { Input } from \"@/components/ui/input\";\r\nimport { Label } from \"@/components/ui/label\";\r\nimport { createBill, updateBill } from \"@/actions/bill\";\r\nimport { toast } from \"sonner\";\r\nimport { Plus, Edit } from \"lucide-react\";\r\n\r\ntype Bill = {\r\n    id: number;\r\n    description: string;\r\n    amount: number;\r\n    billDate: Date | string;\r\n    invoiceNumber: string | null;\r\n    fileUrl: string | null;\r\n    projectId: number;\r\n};\r\n\r\nexport function BillDialog({\r\n    projectId,\r\n    bill,\r\n    trigger,\r\n    mode = \"create\",\r\n}: {\r\n    projectId: number;\r\n    bill?: Bill;\r\n    trigger?: React.ReactNode;\r\n    mode?: \"create\" | \"edit\";\r\n}) {\r\n    const [open, setOpen] = useState(false);\r\n    const [isPending, startTransition] = useTransition();\r\n\r\n    const [formData, setFormData] = useState({\r\n        description: bill?.description || \"\",\r\n        amount: bill?.amount ? String(bill.amount) : \"\",\r\n        billDate: bill?.billDate ? new Date(bill.billDate).toISOString().split('T')[0] : new Date().toISOString().split('T')[0],\r\n        invoiceNumber: bill?.invoiceNumber || \"\",\r\n    });\r\n\r\n    useEffect(() => {\r\n        if (open && mode === \"edit\" && bill) {\r\n            setFormData({\r\n                description: bill.description,\r\n                amount: String(bill.amount),\r\n                billDate: new Date(bill.billDate).toISOString().split('T')[0],\r\n                invoiceNumber: bill.invoiceNumber || \"\",\r\n            });\r\n        } else if (open && mode === \"create\") {\r\n            setFormData({\r\n                description: \"\",\r\n                amount: \"\",\r\n                billDate: new Date().toISOString().split('T')[0],\r\n                invoiceNumber: \"\",\r\n            });\r\n        }\r\n    }, [open, mode, bill]);\r\n\r\n    const handleSubmit = async (e: React.FormEvent) => {\r\n        e.preventDefault();\r\n\r\n        startTransition(async () => {\r\n            try {\r\n                const formDataToSend = new FormData();\r\n                formDataToSend.append(\"description\", formData.description);\r\n                formDataToSend.append(\"amount\", formData.amount);\r\n                formDataToSend.append(\"billDate\", formData.billDate);\r\n                formDataToSend.append(\"invoiceNumber\", formData.invoiceNumber);\r\n                formDataToSend.append(\"projectId\", String(projectId));\r\n\r\n                // @ts-ignore\r\n                const fileInput = window.billFileInput as HTMLInputElement;\r\n                if (fileInput && fileInput.files && fileInput.files[0]) {\r\n                    formDataToSend.append(\"file\", fileInput.files[0]);\r\n                }\r\n\r\n                let result;\r\n                if (mode === \"edit\" && bill) {\r\n                    result = await updateBill(bill.id, formDataToSend);\r\n                } else {\r\n                    result = await createBill(formDataToSend);\r\n                }\r\n\r\n                if (result.success) {\r\n                    toast.success(mode === \"create\" ? \"Bill created successfully\" : \"Bill updated successfully\");\r\n                    setOpen(false);\r\n                    if (mode === \"create\") {\r\n                        setFormData({\r\n                            description: \"\",\r\n                            amount: \"\",\r\n                            billDate: new Date().toISOString().split('T')[0],\r\n                            invoiceNumber: \"\",\r\n                        });\r\n                        // @ts-ignore\r\n                        if (window.billFileInput) window.billFileInput.value = \"\";\r\n                    }\r\n                } else {\r\n                    toast.error(result.error);\r\n                }\r\n            } catch (error) {\r\n                console.error(error);\r\n                toast.error(\"An error occurred\");\r\n            }\r\n        });\r\n    };\r\n\r\n    return (\r\n        <Dialog open={open} onOpenChange={setOpen}>\r\n            <DialogTrigger asChild>\r\n                {trigger || (\r\n                    <Button variant=\"outline\" size=\"sm\">\r\n                        <Plus className=\"mr-2 h-4 w-4\" /> Add Bill\r\n                    </Button>\r\n                )}\r\n            </DialogTrigger>\r\n            <DialogContent className=\"sm:max-w-[425px]\">\r\n                <DialogHeader>\r\n                    <DialogTitle>{mode === \"create\" ? \"Add Bill\" : \"Edit Bill\"}</DialogTitle>\r\n                </DialogHeader>\r\n                <form onSubmit={handleSubmit} className=\"space-y-4\">\r\n\r\n                    <div className=\"space-y-2\">\r\n                        <Label htmlFor=\"description\">Description</Label>\r\n                        <Input\r\n                            id=\"description\"\r\n                            required\r\n                            value={formData.description}\r\n                            onChange={(e) => setFormData({ ...formData, description: e.target.value })}\r\n                            placeholder=\"Material purchase, etc.\"\r\n                        />\r\n                    </div>\r\n\r\n                    <div className=\"grid grid-cols-2 gap-4\">\r\n                        <div className=\"space-y-2\">\r\n                            <Label htmlFor=\"amount\">Amount</Label>\r\n                            <Input\r\n                                id=\"amount\"\r\n                                type=\"number\"\r\n                                step=\"0.01\"\r\n                                required\r\n                                value={formData.amount}\r\n                                onChange={(e) => setFormData({ ...formData, amount: e.target.value })}\r\n                            />\r\n                        </div>\r\n                        <div className=\"space-y-2\">\r\n                            <Label htmlFor=\"billDate\">Date</Label>\r\n                            <Input\r\n                                id=\"billDate\"\r\n                                type=\"date\"\r\n                                required\r\n                                value={formData.billDate}\r\n                                onChange={(e) => setFormData({ ...formData, billDate: e.target.value })}\r\n                            />\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div className=\"space-y-2\">\r\n                        <Label htmlFor=\"invoiceNumber\">Invoice Number</Label>\r\n                        <Input\r\n                            id=\"invoiceNumber\"\r\n                            value={formData.invoiceNumber}\r\n                            onChange={(e) => setFormData({ ...formData, invoiceNumber: e.target.value })}\r\n                        />\r\n                    </div>\r\n\r\n                    <div className=\"space-y-2\">\r\n                        <Label htmlFor=\"file\">Bill File (PDF, Image, Word)</Label>\r\n                        <Input\r\n                            id=\"file\"\r\n                            type=\"file\"\r\n                            className=\"cursor-pointer\"\r\n                            ref={(input) => {\r\n                                // @ts-ignore\r\n                                window.billFileInput = input;\r\n                            }}\r\n                        />\r\n                        {mode === \"edit\" && bill?.fileUrl && (\r\n                            <p className=\"text-xs text-zinc-500 mt-1\">Current file: <a href={bill.fileUrl} target=\"_blank\" className=\"text-blue-500 hover:underline\">View</a>. Upload new to replace.</p>\r\n                        )}\r\n                    </div>\r\n\r\n                    <DialogFooter>\r\n                        <Button type=\"submit\" disabled={isPending}>\r\n                            {isPending ? \"Saving...\" : \"Save Bill\"}\r\n                        </Button>\r\n                    </DialogFooter>\r\n                </form>\r\n            </DialogContent>\r\n        </Dialog>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\gemini antigravity works\\Construction app\\src\\components\\company-document-manager.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useState' is defined but never used.","line":3,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":3,"endColumn":18},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CardFooter' is defined but never used.","line":11,"column":46,"nodeType":null,"messageId":"unusedVar","endLine":11,"endColumn":56}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useState, useTransition } from \"react\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Input } from \"@/components/ui/input\";\r\nimport { Label } from \"@/components/ui/label\";\r\nimport { toast } from \"sonner\";\r\nimport { FileIcon, Loader2, Trash2, Upload, Eye } from \"lucide-react\";\r\nimport { uploadCompanyDocument, deleteCompanyDocument } from \"@/actions/company-document\";\r\nimport Link from \"next/link\";\r\nimport { Card, CardContent, CardDescription, CardFooter, CardHeader, CardTitle } from \"@/components/ui/card\";\r\n\r\ninterface CompanyDocument {\r\n    id: number;\r\n    name: string;\r\n    url: string;\r\n    type: string;\r\n    createdAt: Date;\r\n}\r\n\r\nexport function CompanyDocumentManager({ documents }: { documents: CompanyDocument[] }) {\r\n    const [isPending, startTransition] = useTransition();\r\n    const [isDeleting, startDeleteTransition] = useTransition();\r\n\r\n    const handleUpload = async (e: React.FormEvent<HTMLFormElement>) => {\r\n        e.preventDefault();\r\n        const formData = new FormData(e.currentTarget);\r\n        const file = formData.get(\"file\") as File;\r\n\r\n        if (!file || file.size === 0) {\r\n            toast.error(\"Please select a file to upload\");\r\n            return;\r\n        }\r\n\r\n        startTransition(async () => {\r\n            const result = await uploadCompanyDocument(formData);\r\n            if (result.error) {\r\n                toast.error(result.error);\r\n            } else {\r\n                toast.success(\"Document uploaded\");\r\n                // Reset form\r\n                (e.target as HTMLFormElement).reset();\r\n            }\r\n        });\r\n    };\r\n\r\n    const handleDelete = async (id: number) => {\r\n        if (!confirm(\"Are you sure you want to delete this document?\")) return;\r\n\r\n        startDeleteTransition(async () => {\r\n            const result = await deleteCompanyDocument(id);\r\n            if (result.error) {\r\n                toast.error(result.error);\r\n            } else {\r\n                toast.success(\"Document deleted\");\r\n            }\r\n        });\r\n    };\r\n\r\n    return (\r\n        <Card className=\"w-full max-w-2xl mx-auto shadow-md border-zinc-200 dark:border-zinc-800 mt-6\">\r\n            <CardHeader>\r\n                <CardTitle>Company Documents</CardTitle>\r\n                <CardDescription>\r\n                    Upload certificates, licenses, and other company-related documents.\r\n                </CardDescription>\r\n            </CardHeader>\r\n            <CardContent className=\"space-y-6\">\r\n\r\n                {/* Upload Section */}\r\n                <form onSubmit={handleUpload} className=\"flex items-end gap-4 border-b border-zinc-100 pb-6\">\r\n                    <div className=\"grid w-full items-center gap-1.5\">\r\n                        <Label htmlFor=\"doc-upload\">Upload Document</Label>\r\n                        <Input id=\"doc-upload\" name=\"file\" type=\"file\" required className=\"cursor-pointer\" />\r\n                    </div>\r\n                    <Button type=\"submit\" disabled={isPending}>\r\n                        {isPending ? <Loader2 className=\"h-4 w-4 animate-spin\" /> : <Upload className=\"h-4 w-4 mr-2\" />}\r\n                        Upload\r\n                    </Button>\r\n                </form>\r\n\r\n                {/* Documents List */}\r\n                <div className=\"space-y-4\">\r\n                    <h3 className=\"text-sm font-medium text-zinc-500\">Uploaded Documents</h3>\r\n                    {documents.length === 0 ? (\r\n                        <p className=\"text-sm text-zinc-400 italic\">No documents uploaded yet.</p>\r\n                    ) : (\r\n                        <div className=\"grid gap-3\">\r\n                            {documents.map((doc) => (\r\n                                <div key={doc.id} className=\"flex items-center justify-between p-3 bg-zinc-50 dark:bg-zinc-900 rounded-lg border border-zinc-100 dark:border-zinc-800\">\r\n                                    <div className=\"flex items-center gap-3 overflow-hidden\">\r\n                                        <div className=\"h-10 w-10 rounded-full bg-blue-100 dark:bg-blue-900/30 flex items-center justify-center flex-shrink-0\">\r\n                                            <FileIcon className=\"h-5 w-5 text-blue-600 dark:text-blue-400\" />\r\n                                        </div>\r\n                                        <div className=\"min-w-0\">\r\n                                            <Link href={doc.url} target=\"_blank\" className=\"hover:underline\">\r\n                                                <p className=\"text-sm font-medium truncate\">{doc.name}</p>\r\n                                            </Link>\r\n                                            <p className=\"text-xs text-zinc-500\">{new Date(doc.createdAt).toLocaleDateString()}</p>\r\n                                        </div>\r\n                                    </div>\r\n                                    <div className=\"flex items-center gap-2\">\r\n                                        <Link href={doc.url} target=\"_blank\" passHref>\r\n                                            <Button variant=\"ghost\" size=\"icon\" className=\"h-8 w-8 text-zinc-500 hover:text-zinc-900\">\r\n                                                <Eye className=\"h-4 w-4\" />\r\n                                            </Button>\r\n                                        </Link>\r\n                                        <Button\r\n                                            variant=\"ghost\"\r\n                                            size=\"icon\"\r\n                                            className=\"h-8 w-8 text-red-500 hover:text-red-700 hover:bg-red-50\"\r\n                                            onClick={() => handleDelete(doc.id)}\r\n                                            disabled={isDeleting}\r\n                                        >\r\n                                            <Trash2 className=\"h-4 w-4\" />\r\n                                        </Button>\r\n                                    </div>\r\n                                </div>\r\n                            ))}\r\n                        </div>\r\n                    )}\r\n                </div>\r\n            </CardContent>\r\n        </Card>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\gemini antigravity works\\Construction app\\src\\components\\company-gallery-manager.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Upload' is defined but never used.","line":8,"column":27,"nodeType":null,"messageId":"unusedVar","endLine":8,"endColumn":33}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useState, useTransition } from \"react\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Input } from \"@/components/ui/input\";\r\nimport { Label } from \"@/components/ui/label\";\r\nimport { toast } from \"sonner\";\r\nimport { Loader2, Trash2, Upload, Plus } from \"lucide-react\";\r\nimport { uploadCompanyImage, deleteCompanyImage } from \"@/actions/company-image\";\r\nimport Image from \"next/image\";\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\r\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogTrigger } from \"@/components/ui/dialog\";\r\n\r\ninterface CompanyImage {\r\n    id: number;\r\n    url: string;\r\n    caption?: string | null;\r\n    createdAt: Date;\r\n}\r\n\r\nexport function CompanyGalleryManager({ images }: { images: CompanyImage[] }) {\r\n    const [isPending, startTransition] = useTransition();\r\n    const [isDeleting, startDeleteTransition] = useTransition();\r\n    const [isOpen, setIsOpen] = useState(false);\r\n\r\n    const handleUpload = async (e: React.FormEvent<HTMLFormElement>) => {\r\n        e.preventDefault();\r\n        const formData = new FormData(e.currentTarget);\r\n        const file = formData.get(\"file\") as File;\r\n\r\n        if (!file || file.size === 0) {\r\n            toast.error(\"Please select an image to upload\");\r\n            return;\r\n        }\r\n\r\n        startTransition(async () => {\r\n            const result = await uploadCompanyImage(formData);\r\n            if (result.error) {\r\n                toast.error(result.error);\r\n            } else {\r\n                toast.success(\"Image uploaded\");\r\n                setIsOpen(false);\r\n            }\r\n        });\r\n    };\r\n\r\n    const handleDelete = async (id: number) => {\r\n        if (!confirm(\"Delete this image?\")) return;\r\n\r\n        startDeleteTransition(async () => {\r\n            const result = await deleteCompanyImage(id);\r\n            if (result.error) {\r\n                toast.error(result.error);\r\n            } else {\r\n                toast.success(\"Image deleted\");\r\n            }\r\n        });\r\n    };\r\n\r\n    return (\r\n        <Card className=\"w-full max-w-2xl mx-auto shadow-md border-zinc-200 dark:border-zinc-800 mt-6\">\r\n            <CardHeader className=\"flex flex-row items-center justify-between\">\r\n                <div>\r\n                    <CardTitle>Company Gallery</CardTitle>\r\n                    <CardDescription>\r\n                        Upload posters, site images, and other company assets.\r\n                    </CardDescription>\r\n                </div>\r\n                <Dialog open={isOpen} onOpenChange={setIsOpen}>\r\n                    <DialogTrigger asChild>\r\n                        <Button size=\"sm\">\r\n                            <Plus className=\"h-4 w-4 mr-2\" />\r\n                            Add Image\r\n                        </Button>\r\n                    </DialogTrigger>\r\n                    <DialogContent>\r\n                        <DialogHeader>\r\n                            <DialogTitle>Upload Image</DialogTitle>\r\n                        </DialogHeader>\r\n                        <form onSubmit={handleUpload} className=\"space-y-4\">\r\n                            <div className=\"grid w-full items-center gap-1.5\">\r\n                                <Label htmlFor=\"img-upload\">Image File</Label>\r\n                                <Input id=\"img-upload\" name=\"file\" type=\"file\" accept=\"image/*\" required />\r\n                            </div>\r\n                            <Button type=\"submit\" className=\"w-full\" disabled={isPending}>\r\n                                {isPending ? <Loader2 className=\"h-4 w-4 animate-spin\" /> : \"Upload\"}\r\n                            </Button>\r\n                        </form>\r\n                    </DialogContent>\r\n                </Dialog>\r\n            </CardHeader>\r\n            <CardContent>\r\n                {images.length === 0 ? (\r\n                    <div className=\"text-center py-10 border-2 border-dashed border-zinc-100 rounded-lg\">\r\n                        <p className=\"text-zinc-400 italic\">No images uploaded.</p>\r\n                    </div>\r\n                ) : (\r\n                    <div className=\"grid grid-cols-2 md:grid-cols-3 gap-4\">\r\n                        {images.map((img) => (\r\n                            <div key={img.id} className=\"relative group aspect-square bg-zinc-100 rounded-lg overflow-hidden border border-zinc-200\">\r\n                                <Image\r\n                                    src={img.url}\r\n                                    alt=\"Gallery Image\"\r\n                                    fill\r\n                                    className=\"object-cover transition-transform group-hover:scale-105\"\r\n                                />\r\n                                <div className=\"absolute inset-0 bg-black/40 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center\">\r\n                                    <Button\r\n                                        variant=\"destructive\"\r\n                                        size=\"icon\"\r\n                                        onClick={() => handleDelete(img.id)}\r\n                                        disabled={isDeleting}\r\n                                    >\r\n                                        <Trash2 className=\"h-4 w-4\" />\r\n                                    </Button>\r\n                                    <a href={img.url} target=\"_blank\" rel=\"noreferrer\" className=\"absolute top-2 right-2 text-white hover:text-blue-200\">\r\n                                        <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"><path d=\"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6\"></path><polyline points=\"15 3 21 3 21 9\"></polyline><line x1=\"10\" y1=\"14\" x2=\"21\" y2=\"3\"></line></svg>\r\n                                    </a>\r\n                                </div>\r\n                            </div>\r\n                        ))}\r\n                    </div>\r\n                )}\r\n            </CardContent>\r\n        </Card>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\gemini antigravity works\\Construction app\\src\\components\\customer-delete-button.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\gemini antigravity works\\Construction app\\src\\components\\customer-dialog.tsx","messages":[{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nD:\\gemini antigravity works\\Construction app\\src\\components\\customer-dialog.tsx:69:17\n  67 |         if (open) {\n  68 |             if (customer && mode === 'edit') {\n> 69 |                 setImageUrl(customer.imageUrl || null);\n     |                 ^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  70 |             } else {\n  71 |                 setImageUrl(null);\n  72 |             }","line":69,"column":17,"nodeType":null,"endLine":69,"endColumn":28}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useTransition, useState, useEffect } from \"react\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport {\r\n    Dialog,\r\n    DialogContent,\r\n    DialogHeader,\r\n    DialogTitle,\r\n    DialogTrigger,\r\n} from \"@/components/ui/dialog\";\r\nimport { Input } from \"@/components/ui/input\";\r\nimport { Label } from \"@/components/ui/label\";\r\nimport { createCustomer, updateCustomer } from \"@/actions/customer\";\r\nimport { toast } from \"sonner\";\r\nimport { Plus, Loader2 } from \"lucide-react\";\r\nimport { ImagePicker } from \"@/components/image-picker\";\r\n\r\ntype Customer = {\r\n    id: number;\r\n    name: string;\r\n    phone: string;\r\n    email: string | null;\r\n    address: string | null;\r\n    idDetails: string | null;\r\n    imageUrl: string | null;\r\n};\r\n\r\nexport function CustomerDialog({\r\n    customer,\r\n    trigger,\r\n    mode = \"create\",\r\n}: {\r\n    customer?: Customer;\r\n    trigger?: React.ReactNode;\r\n    mode?: \"create\" | \"edit\";\r\n}) {\r\n    const [open, setOpen] = useState(false);\r\n    const [isPending, startTransition] = useTransition();\r\n\r\n    const [imageUrl, setImageUrl] = useState<string | null>(null);\r\n\r\n    // Form submission\r\n    const handleSubmit = async (formData: FormData) => {\r\n        startTransition(async () => {\r\n            if (imageUrl) {\r\n                formData.set(\"imageUrl\", imageUrl);\r\n            } else {\r\n                formData.delete(\"imageUrl\");\r\n            }\r\n\r\n            const result = mode === \"create\"\r\n                ? await createCustomer(formData)\r\n                : await updateCustomer(customer!.id, formData);\r\n\r\n            if (result.success) {\r\n                toast.success(result.message);\r\n                setOpen(false);\r\n            } else {\r\n                toast.error(result.error);\r\n            }\r\n        });\r\n    };\r\n\r\n    // Effect to reset/set form state\r\n    useEffect(() => {\r\n        if (open) {\r\n            if (customer && mode === 'edit') {\r\n                setImageUrl(customer.imageUrl || null);\r\n            } else {\r\n                setImageUrl(null);\r\n            }\r\n        }\r\n    }, [open, customer, mode]);\r\n\r\n    return (\r\n        <Dialog open={open} onOpenChange={setOpen}>\r\n            <DialogTrigger asChild>\r\n                {trigger || (\r\n                    <Button>\r\n                        <Plus className=\"mr-2 h-4 w-4\" /> Add Customer\r\n                    </Button>\r\n                )}\r\n            </DialogTrigger>\r\n            <DialogContent>\r\n                <DialogHeader>\r\n                    <DialogTitle>{mode === \"create\" ? \"Add Customer\" : \"Edit Customer\"}</DialogTitle>\r\n                </DialogHeader>\r\n                <form action={handleSubmit} className=\"space-y-4\">\r\n                    <ImagePicker\r\n                        label=\"Profile Photo\"\r\n                        value={imageUrl}\r\n                        onChange={setImageUrl}\r\n                        onRemove={() => setImageUrl(null)}\r\n                        circular={true}\r\n                    />\r\n\r\n                    <div className=\"space-y-2\">\r\n                        <Label htmlFor=\"name\">Name</Label>\r\n                        <Input\r\n                            id=\"name\"\r\n                            name=\"name\"\r\n                            required\r\n                            defaultValue={mode === \"edit\" ? customer?.name : \"\"}\r\n                            placeholder=\"Customer Name\"\r\n                        />\r\n                    </div>\r\n                    <div className=\"space-y-2\">\r\n                        <Label htmlFor=\"phone\">Phone</Label>\r\n                        <Input\r\n                            id=\"phone\"\r\n                            name=\"phone\"\r\n                            required\r\n                            defaultValue={mode === \"edit\" ? customer?.phone : \"\"}\r\n                            placeholder=\"Phone Number\"\r\n                        />\r\n                    </div>\r\n                    <div className=\"grid grid-cols-2 gap-4\">\r\n                        <div className=\"space-y-2\">\r\n                            <Label htmlFor=\"email\">Email</Label>\r\n                            <Input\r\n                                id=\"email\"\r\n                                name=\"email\"\r\n                                type=\"email\"\r\n                                defaultValue={mode === \"edit\" ? customer?.email || \"\" : \"\"}\r\n                                placeholder=\"Email (Optional)\"\r\n                            />\r\n                        </div>\r\n                        <div className=\"space-y-2\">\r\n                            <Label htmlFor=\"idDetails\">ID Proof</Label>\r\n                            <Input\r\n                                id=\"idDetails\"\r\n                                name=\"idDetails\"\r\n                                defaultValue={mode === \"edit\" ? customer?.idDetails || \"\" : \"\"}\r\n                                placeholder=\"ID Proof (Optional)\"\r\n                            />\r\n                        </div>\r\n                    </div>\r\n                    <div className=\"space-y-2\">\r\n                        <Label htmlFor=\"address\">Address</Label>\r\n                        <Input\r\n                            id=\"address\"\r\n                            name=\"address\"\r\n                            defaultValue={mode === \"edit\" ? customer?.address || \"\" : \"\"}\r\n                            placeholder=\"Address (Optional)\"\r\n                        />\r\n                    </div>\r\n                    <div className=\"flex justify-end gap-3 pt-4\">\r\n                        <Button type=\"button\" variant=\"outline\" onClick={() => setOpen(false)}>\r\n                            Cancel\r\n                        </Button>\r\n                        <Button type=\"submit\" disabled={isPending}>\r\n                            {isPending && <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />}\r\n                            {mode === \"create\" ? \"Create\" : \"Save Changes\"}\r\n                        </Button>\r\n                    </div>\r\n                </form>\r\n            </DialogContent>\r\n        </Dialog>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\gemini antigravity works\\Construction app\\src\\components\\document-delete-button.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\gemini antigravity works\\Construction app\\src\\components\\document-uploader.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'_' is defined but never used.","line":29,"column":22,"nodeType":null,"messageId":"unusedVar","endLine":29,"endColumn":23}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\nimport { useState, useTransition } from \"react\";\r\nimport { uploadDocument } from \"@/actions/document\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Input } from \"@/components/ui/input\";\r\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\r\nimport { toast } from \"sonner\";\r\nimport { Upload } from \"lucide-react\";\r\n\r\nexport function DocumentUploader({ projectId }: { projectId: number }) {\r\n    const [file, setFile] = useState<File | null>(null);\r\n    const [type, setType] = useState(\"Plan\");\r\n    const [isPending, startTransition] = useTransition();\r\n\r\n    const handleUpload = () => {\r\n        if (!file) return;\r\n\r\n        const formData = new FormData();\r\n        formData.append(\"file\", file);\r\n        formData.append(\"projectId\", String(projectId));\r\n        formData.append(\"type\", type);\r\n\r\n        startTransition(async () => {\r\n            try {\r\n                await uploadDocument(formData);\r\n                toast.success(\"Document uploaded\");\r\n                setFile(null);\r\n                // Reset file input is tricky without ref, but good enough for now\r\n            } catch (_) {\r\n                toast.error(\"Upload failed\");\r\n            }\r\n        });\r\n    };\r\n\r\n    return (\r\n        <div className=\"flex flex-col sm:flex-row gap-4 items-start sm:items-end border p-4 rounded-md bg-zinc-50 dark:bg-zinc-800\">\r\n            <div className=\"grid w-full items-center gap-1.5\">\r\n                <span className=\"text-sm font-medium\">Add Document</span>\r\n                <Input type=\"file\" onChange={(e) => setFile(e.target.files?.[0] || null)} />\r\n            </div>\r\n            <div className=\"flex flex-col gap-1.5\">\r\n                <span className=\"text-sm font-medium\">Type</span>\r\n                <Select value={type} onValueChange={setType}>\r\n                    <SelectTrigger className=\"w-[180px]\">\r\n                        <SelectValue placeholder=\"Type\" />\r\n                    </SelectTrigger>\r\n                    <SelectContent>\r\n                        <SelectItem value=\"Plan\">Building Plan</SelectItem>\r\n                        <SelectItem value=\"Elevation\">Elevation Plan</SelectItem>\r\n                        <SelectItem value=\"Agreement\">Signed Agreement</SelectItem>\r\n                        <SelectItem value=\"Invoice\">Invoice</SelectItem>\r\n                        <SelectItem value=\"Other\">Other</SelectItem>\r\n                    </SelectContent>\r\n                </Select>\r\n            </div>\r\n            <Button onClick={handleUpload} disabled={!file || isPending}>\r\n                <Upload className=\"mr-2 h-4 w-4\" /> Upload\r\n            </Button>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\gemini antigravity works\\Construction app\\src\\components\\image-cropper-dialog.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\gemini antigravity works\\Construction app\\src\\components\\image-picker.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\gemini antigravity works\\Construction app\\src\\components\\log-error-boundary.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":13,"column":37,"nodeType":null,"messageId":"unusedVar","endLine":13,"endColumn":42},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":13,"column":44,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":13,"endColumn":47,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[423,426],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[423,426],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":17,"column":30,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":17,"endColumn":33,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[505,508],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[505,508],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":17,"column":46,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":17,"endColumn":49,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[521,524],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[521,524],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport React from \"react\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { AlertTriangle } from \"lucide-react\";\r\n\r\nclass LogErrorBoundary extends React.Component<{ children: React.ReactNode }, { hasError: boolean }> {\r\n    constructor(props: { children: React.ReactNode }) {\r\n        super(props);\r\n        this.state = { hasError: false };\r\n    }\r\n\r\n    static getDerivedStateFromError(error: any) {\r\n        return { hasError: true };\r\n    }\r\n\r\n    componentDidCatch(error: any, errorInfo: any) {\r\n        console.error(\"Component Crash:\", error, errorInfo);\r\n    }\r\n\r\n    render() {\r\n        if (this.state.hasError) {\r\n            return (\r\n                <Button variant=\"ghost\" size=\"icon\" className=\"h-8 w-8 text-yellow-500\">\r\n                    <AlertTriangle className=\"h-4 w-4\" />\r\n                </Button>\r\n            );\r\n        }\r\n\r\n        return this.props.children;\r\n    }\r\n}\r\n\r\nexport default LogErrorBoundary;\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\gemini antigravity works\\Construction app\\src\\components\\payment-delete-button.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\gemini antigravity works\\Construction app\\src\\components\\payment-dialog.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'e' is defined but never used.","line":66,"column":18,"nodeType":null,"messageId":"unusedVar","endLine":66,"endColumn":19},{"ruleId":"@typescript-eslint/ban-ts-comment","severity":2,"message":"Use \"@ts-expect-error\" instead of \"@ts-ignore\", as \"@ts-ignore\" will do nothing if the following line is error-free.","line":127,"column":17,"nodeType":"Line","messageId":"tsIgnoreInsteadOfExpectError","endLine":127,"endColumn":30,"suggestions":[{"messageId":"replaceTsIgnoreWithTsExpectError","fix":{"range":[4084,4097],"text":"// @ts-expect-error"},"desc":"Replace \"@ts-ignore\" with \"@ts-expect-error\"."}]},{"ruleId":"@typescript-eslint/ban-ts-comment","severity":2,"message":"Use \"@ts-expect-error\" instead of \"@ts-ignore\", as \"@ts-ignore\" will do nothing if the following line is error-free.","line":148,"column":21,"nodeType":"Line","messageId":"tsIgnoreInsteadOfExpectError","endLine":148,"endColumn":34,"suggestions":[{"messageId":"replaceTsIgnoreWithTsExpectError","fix":{"range":[5118,5131],"text":"// @ts-expect-error"},"desc":"Replace \"@ts-ignore\" with \"@ts-expect-error\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'_' is defined but never used.","line":151,"column":22,"nodeType":null,"messageId":"unusedVar","endLine":151,"endColumn":23},{"ruleId":"@typescript-eslint/ban-ts-comment","severity":2,"message":"Use \"@ts-expect-error\" instead of \"@ts-ignore\", as \"@ts-ignore\" will do nothing if the following line is error-free.","line":266,"column":33,"nodeType":"Line","messageId":"tsIgnoreInsteadOfExpectError","endLine":266,"endColumn":46,"suggestions":[{"messageId":"replaceTsIgnoreWithTsExpectError","fix":{"range":[11010,11023],"text":"// @ts-expect-error"},"desc":"Replace \"@ts-ignore\" with \"@ts-expect-error\"."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useTransition, useState } from \"react\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport {\r\n    Dialog,\r\n    DialogContent,\r\n    DialogHeader,\r\n    DialogTitle,\r\n    DialogTrigger,\r\n    DialogFooter,\r\n} from \"@/components/ui/dialog\";\r\nimport { Input } from \"@/components/ui/input\";\r\nimport { Label } from \"@/components/ui/label\";\r\nimport {\r\n    Select,\r\n    SelectContent,\r\n    SelectItem,\r\n    SelectTrigger,\r\n    SelectValue,\r\n} from \"@/components/ui/select\";\r\nimport { Textarea } from \"@/components/ui/textarea\";\r\nimport { createPayment, updatePayment } from \"@/actions/payment\";\r\nimport { toast } from \"sonner\";\r\nimport { Plus } from \"lucide-react\";\r\n\r\ntype Payment = {\r\n    id: number;\r\n    amount: number;\r\n    date: Date | string;\r\n    mode: string;\r\n    reference: string | null;\r\n    remarks: string | null;\r\n    projectId: number;\r\n};\r\n\r\nexport function PaymentDialog({\r\n    payment,\r\n    projectId,\r\n    projects, // Optional if global call\r\n    trigger,\r\n    mode = \"create\",\r\n    open,\r\n    onOpenChange,\r\n}: {\r\n    payment?: Payment;\r\n    projectId?: number;\r\n    projects?: { id: number; name: string }[];\r\n    trigger?: React.ReactNode;\r\n    mode?: \"create\" | \"edit\";\r\n    open?: boolean;\r\n    onOpenChange?: (open: boolean) => void;\r\n}) {\r\n    const [internalOpen, setInternalOpen] = useState(false);\r\n    const isControlled = open !== undefined;\r\n    const finalOpen = isControlled ? open : internalOpen;\r\n    const finalSetOpen = isControlled ? onOpenChange : setInternalOpen;\r\n\r\n    const [isPending, startTransition] = useTransition();\r\n\r\n    // Helper to safely format date\r\n    const safeDate = (date: Date | string | null | undefined) => {\r\n        if (!date) return new Date().toISOString().split('T')[0];\r\n        try {\r\n            return new Date(date).toISOString().split('T')[0];\r\n        } catch (e) {\r\n            console.error(\"Invalid date:\", date);\r\n            return new Date().toISOString().split('T')[0];\r\n        }\r\n    };\r\n\r\n    const [formData, setFormData] = useState({\r\n        amount: \"\",\r\n        date: new Date().toISOString().split('T')[0],\r\n        mode: \"Cash\",\r\n        reference: \"\",\r\n        remarks: \"\",\r\n        projectId: \"\"\r\n    });\r\n\r\n    // Update form data when payment prop changes\r\n    useState(() => {\r\n        if (payment) {\r\n            setFormData({\r\n                amount: String(payment.amount),\r\n                date: safeDate(payment.date),\r\n                mode: payment.mode,\r\n                reference: payment.reference || \"\",\r\n                remarks: payment.remarks || \"\",\r\n                projectId: String(payment.projectId)\r\n            });\r\n        }\r\n    });\r\n\r\n    // Also sync when dialog opens if needed, or rely on parent passing correct payment\r\n    // Better to use useEffect for updates if the parent changes 'payment' while mounted\r\n    const [prevPaymentId, setPrevPaymentId] = useState<number | null>(null);\r\n    if (payment && payment.id !== prevPaymentId) {\r\n        setPrevPaymentId(payment.id);\r\n        setFormData({\r\n            amount: String(payment.amount),\r\n            date: safeDate(payment.date),\r\n            mode: payment.mode,\r\n            reference: payment.reference || \"\",\r\n            remarks: payment.remarks || \"\",\r\n            projectId: String(payment.projectId)\r\n        });\r\n    }\r\n\r\n    const handleSubmit = async (e: React.FormEvent) => {\r\n        e.preventDefault();\r\n        if (!formData.projectId) {\r\n            toast.error(\"Project is required\");\r\n            return;\r\n        }\r\n\r\n        startTransition(async () => {\r\n            try {\r\n                const formDataToSend = new FormData();\r\n                formDataToSend.append(\"amount\", formData.amount);\r\n                formDataToSend.append(\"date\", formData.date);\r\n                formDataToSend.append(\"mode\", formData.mode);\r\n                formDataToSend.append(\"reference\", formData.reference);\r\n                formDataToSend.append(\"remarks\", formData.remarks);\r\n                formDataToSend.append(\"projectId\", formData.projectId);\r\n\r\n                // @ts-ignore\r\n                const fileInput = window.paymentFileInput as HTMLInputElement;\r\n                if (fileInput && fileInput.files) {\r\n                    for (let i = 0; i < fileInput.files.length; i++) {\r\n                        formDataToSend.append(\"files\", fileInput.files[i]);\r\n                    }\r\n                }\r\n\r\n                if (mode === \"edit\" && payment) {\r\n                    await updatePayment(payment.id, formDataToSend);\r\n                    toast.success(\"Payment updated\");\r\n                } else {\r\n                    await createPayment(formDataToSend);\r\n                    toast.success(\"Payment recorded\");\r\n                }\r\n                finalSetOpen?.(false);\r\n                if (mode === \"create\") {\r\n                    setFormData({\r\n                        amount: \"\", date: new Date().toISOString().split('T')[0], mode: \"Cash\", reference: \"\", remarks: \"\",\r\n                        projectId: projectId ? String(projectId) : \"\"\r\n                    });\r\n                    // @ts-ignore\r\n                    if (window.paymentFileInput) window.paymentFileInput.value = \"\";\r\n                }\r\n            } catch (_) {\r\n                toast.error(\"An error occurred\");\r\n            }\r\n        });\r\n    };\r\n\r\n    return (\r\n        <Dialog open={finalOpen} onOpenChange={finalSetOpen}>\r\n            {trigger !== null && (\r\n                <DialogTrigger asChild>\r\n                    {trigger ? (\r\n                        trigger\r\n                    ) : (\r\n                        <Button variant=\"outline\" size=\"sm\">\r\n                            <Plus className=\"mr-2 h-4 w-4\" /> Record Payment\r\n                        </Button>\r\n                    )}\r\n                </DialogTrigger>\r\n            )}\r\n            <DialogContent className=\"sm:max-w-[425px]\">\r\n                <DialogHeader>\r\n                    <DialogTitle>{mode === \"create\" ? \"Record Payment\" : \"Edit Payment\"}</DialogTitle>\r\n                </DialogHeader>\r\n                <form onSubmit={handleSubmit} className=\"space-y-4\">\r\n\r\n                    {!projectId && projects && (\r\n                        <div className=\"space-y-2\">\r\n                            <Label htmlFor=\"project\">Project</Label>\r\n                            <Select value={formData.projectId} onValueChange={(val) => setFormData({ ...formData, projectId: val })}>\r\n                                <SelectTrigger>\r\n                                    <SelectValue placeholder=\"Select project\" />\r\n                                </SelectTrigger>\r\n                                <SelectContent>\r\n                                    {projects.map(p => (\r\n                                        <SelectItem key={p.id} value={String(p.id)}>{p.name}</SelectItem>\r\n                                    ))}\r\n                                </SelectContent>\r\n                            </Select>\r\n                        </div>\r\n                    )}\r\n\r\n                    <div className=\"space-y-2\">\r\n                        <Label htmlFor=\"amount\">Amount</Label>\r\n                        <Input\r\n                            id=\"amount\"\r\n                            type=\"number\"\r\n                            step=\"0.01\"\r\n                            required\r\n                            value={formData.amount}\r\n                            onChange={(e) => setFormData({ ...formData, amount: e.target.value })}\r\n                        />\r\n                    </div>\r\n\r\n                    <div className=\"grid grid-cols-2 gap-4\">\r\n                        <div className=\"space-y-2\">\r\n                            <Label htmlFor=\"date\">Date</Label>\r\n                            <Input\r\n                                id=\"date\"\r\n                                type=\"date\"\r\n                                required\r\n                                value={formData.date}\r\n                                onChange={(e) => setFormData({ ...formData, date: e.target.value })}\r\n                            />\r\n                        </div>\r\n                        <div className=\"space-y-2\">\r\n                            <Label htmlFor=\"mode\">Payment Mode</Label>\r\n                            <Select value={formData.mode} onValueChange={(val) => setFormData({ ...formData, mode: val })}>\r\n                                <SelectTrigger>\r\n                                    <SelectValue placeholder=\"Select mode\" />\r\n                                </SelectTrigger>\r\n                                <SelectContent>\r\n                                    <SelectItem value=\"Cash\">Cash</SelectItem>\r\n                                    <SelectItem value=\"Bank Transfer\">Bank Transfer</SelectItem>\r\n                                    <SelectItem value=\"Cheque\">Cheque</SelectItem>\r\n                                    <SelectItem value=\"UPI\">UPI</SelectItem>\r\n                                </SelectContent>\r\n                            </Select>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div className=\"space-y-2\">\r\n                        <Label htmlFor=\"reference\">Reference No.</Label>\r\n                        <Input\r\n                            id=\"reference\"\r\n                            placeholder=\"Cheque/Transaction ID\"\r\n                            value={formData.reference}\r\n                            onChange={(e) => setFormData({ ...formData, reference: e.target.value })}\r\n                        />\r\n                    </div>\r\n\r\n                    <div className=\"space-y-2\">\r\n                        <Label htmlFor=\"remarks\">Remarks</Label>\r\n                        <Textarea\r\n                            id=\"remarks\"\r\n                            value={formData.remarks}\r\n                            onChange={(e) => setFormData({ ...formData, remarks: e.target.value })}\r\n                        />\r\n                    </div>\r\n\r\n                    <div className=\"space-y-2\">\r\n                        <Label htmlFor=\"files\">Attach Bills</Label>\r\n                        <Input\r\n                            id=\"files\"\r\n                            type=\"file\"\r\n                            multiple\r\n                            className=\"cursor-pointer\"\r\n                            onChange={(e) => {\r\n                                if (e.target.files) {\r\n                                    // We need to handle this in handleSubmit by using the input ref or state\r\n                                    // For simplicity in this controlled form, we can just let the form submit handle it via standard Request submission\r\n                                    // BUT, we are constructing the formData object manually in handleSubmit.\r\n                                    // So we need to store the files in state.\r\n                                }\r\n                            }}\r\n                            ref={(input) => {\r\n                                // @ts-ignore\r\n                                window.paymentFileInput = input;\r\n                            }}\r\n                        />\r\n                        <p className=\"text-xs text-zinc-500\">You can select multiple files.</p>\r\n                    </div>\r\n\r\n                    <DialogFooter>\r\n                        <Button type=\"submit\" disabled={isPending}>\r\n                            {isPending ? \"Saving...\" : \"Save\"}\r\n                        </Button>\r\n                    </DialogFooter>\r\n                </form>\r\n            </DialogContent>\r\n        </Dialog>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\gemini antigravity works\\Construction app\\src\\components\\payments-table.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ErrorBoundary' is defined but never used.","line":3,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":3,"endColumn":23},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":19,"column":67,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":19,"endColumn":70,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[577,580],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[577,580],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":19,"column":84,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":19,"endColumn":87,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[594,597],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[594,597],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":20,"column":58,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":20,"endColumn":61,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[663,666],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[663,666],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":23,"column":39,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":23,"endColumn":42,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[778,781],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[778,781],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":44,"column":53,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":44,"endColumn":56,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1816,1819],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1816,1819],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":75,"column":66,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[4033,4166],"text":"\r\n                                        No payments found. Click &quot;Record Payment\" to add one.\r\n                                    "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[4033,4166],"text":"\r\n                                        No payments found. Click &ldquo;Record Payment\" to add one.\r\n                                    "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[4033,4166],"text":"\r\n                                        No payments found. Click &#34;Record Payment\" to add one.\r\n                                    "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[4033,4166],"text":"\r\n                                        No payments found. Click &rdquo;Record Payment\" to add one.\r\n                                    "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":75,"column":81,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[4033,4166],"text":"\r\n                                        No payments found. Click \"Record Payment&quot; to add one.\r\n                                    "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[4033,4166],"text":"\r\n                                        No payments found. Click \"Record Payment&ldquo; to add one.\r\n                                    "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[4033,4166],"text":"\r\n                                        No payments found. Click \"Record Payment&#34; to add one.\r\n                                    "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[4033,4166],"text":"\r\n                                        No payments found. Click \"Record Payment&rdquo; to add one.\r\n                                    "},"desc":"Replace with `&rdquo;`."}]}],"suppressedMessages":[],"errorCount":7,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { ErrorBoundary } from \"@/components/ui/error-boundary\";\r\nimport { PaymentDialog } from \"@/components/payment-dialog\";\r\nimport { PaymentDeleteButton } from \"@/components/payment-delete-button\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport {\r\n    Table,\r\n    TableBody,\r\n    TableCell,\r\n    TableHead,\r\n    TableHeader,\r\n    TableRow,\r\n} from \"@/components/ui/table\";\r\nimport { Edit } from \"lucide-react\";\r\nimport Link from \"next/link\";\r\nimport { useState } from \"react\";\r\n\r\nexport function PaymentsTable({ payments, projects }: { payments: any[], projects: any[] }) {\r\n    const [editingPayment, setEditingPayment] = useState<any>(null);\r\n    const [isDialogOpen, setIsDialogOpen] = useState(false);\r\n\r\n    const handleEditClick = (payment: any) => {\r\n        setEditingPayment(payment);\r\n        setIsDialogOpen(true);\r\n    };\r\n\r\n    return (\r\n        <>\r\n            <div className=\"bg-white dark:bg-zinc-900 rounded-lg shadow-sm border border-zinc-200 dark:border-zinc-800 overflow-hidden\">\r\n                <div className=\"overflow-x-auto\">\r\n                    <Table>\r\n                        <TableHeader>\r\n                            <TableRow className=\"bg-zinc-50 dark:bg-zinc-900/50\">\r\n                                <TableHead>Date</TableHead>\r\n                                <TableHead>Project</TableHead>\r\n                                <TableHead>Amount</TableHead>\r\n                                <TableHead>Mode</TableHead>\r\n                                <TableHead>Reference</TableHead>\r\n                                <TableHead className=\"w-[100px] text-right\">Actions</TableHead>\r\n                            </TableRow>\r\n                        </TableHeader>\r\n                        <TableBody>\r\n                            {payments.map((payment: any) => (\r\n                                <TableRow key={payment.id}>\r\n                                    <TableCell className=\"font-medium text-zinc-500\" suppressHydrationWarning>\r\n                                        {new Date(payment.date).toLocaleDateString()}\r\n                                    </TableCell>\r\n                                    <TableCell>\r\n                                        <Link href={`/projects/${payment.projectId}`} className=\"hover:underline text-blue-600\">\r\n                                            {payment.project.name}\r\n                                        </Link>\r\n                                    </TableCell>\r\n                                    <TableCell className=\"font-semibold\">{new Intl.NumberFormat('en-IN', { style: 'currency', currency: 'INR' }).format(payment.amount)}</TableCell>\r\n                                    <TableCell>{payment.mode}</TableCell>\r\n                                    <TableCell className=\"text-zinc-500\">{payment.reference || \"-\"}</TableCell>\r\n                                    <TableCell className=\"text-right\">\r\n                                        <div className=\"flex items-center justify-end gap-2\">\r\n                                            <Button\r\n                                                variant=\"ghost\"\r\n                                                size=\"icon\"\r\n                                                className=\"h-8 w-8\"\r\n                                                onClick={() => handleEditClick(payment)}\r\n                                            >\r\n                                                <Edit className=\"h-4 w-4\" />\r\n                                            </Button>\r\n                                            <PaymentDeleteButton id={payment.id} projectId={payment.projectId} />\r\n                                        </div>\r\n                                    </TableCell>\r\n                                </TableRow>\r\n                            ))}\r\n                            {payments.length === 0 && (\r\n                                <TableRow>\r\n                                    <TableCell colSpan={6} className=\"text-center py-10 text-zinc-500\">\r\n                                        No payments found. Click \"Record Payment\" to add one.\r\n                                    </TableCell>\r\n                                </TableRow>\r\n                            )}\r\n                        </TableBody>\r\n                    </Table>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Shared Edit Dialog */}\r\n            <PaymentDialog\r\n                mode=\"edit\"\r\n                open={isDialogOpen}\r\n                onOpenChange={setIsDialogOpen}\r\n                payment={editingPayment ? {\r\n                    ...editingPayment,\r\n                    date: new Date(editingPayment.date).toISOString()\r\n                } : undefined}\r\n                projects={projects}\r\n                trigger={null}\r\n            />\r\n        </>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\gemini antigravity works\\Construction app\\src\\components\\profile-form.tsx","messages":[],"suppressedMessages":[{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":145,"column":49,"nodeType":"JSXOpeningElement","endLine":149,"endColumn":51,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":183,"column":49,"nodeType":"JSXOpeningElement","endLine":187,"endColumn":51,"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\gemini antigravity works\\Construction app\\src\\components\\project-delete-button.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\gemini antigravity works\\Construction app\\src\\components\\project-dialog.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'e' is defined but never used.","line":71,"column":18,"nodeType":null,"messageId":"unusedVar","endLine":71,"endColumn":19},{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nD:\\gemini antigravity works\\Construction app\\src\\components\\project-dialog.tsx:91:13\n  89 |     useEffect(() => {\n  90 |         if (project) {\n> 91 |             setFormData({\n     |             ^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  92 |                 name: project.name || \"\",\n  93 |                 location: project.location || \"\",\n  94 |                 area: project.area || \"\",","line":91,"column":13,"nodeType":null,"endLine":91,"endColumn":24},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'_' is defined but never used.","line":146,"column":22,"nodeType":null,"messageId":"unusedVar","endLine":146,"endColumn":23}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useTransition, useState, useEffect } from \"react\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport {\r\n    Dialog,\r\n    DialogContent,\r\n    DialogHeader,\r\n    DialogTitle,\r\n    DialogTrigger,\r\n    DialogFooter,\r\n} from \"@/components/ui/dialog\";\r\nimport { Input } from \"@/components/ui/input\";\r\nimport { Label } from \"@/components/ui/label\";\r\nimport {\r\n    Select,\r\n    SelectContent,\r\n    SelectItem,\r\n    SelectTrigger,\r\n    SelectValue,\r\n} from \"@/components/ui/select\";\r\nimport { createProject, updateProject } from \"@/actions/project\";\r\nimport { toast } from \"sonner\";\r\nimport { Plus, Loader2 } from \"lucide-react\";\r\nimport { Customer } from \"@prisma/client\";\r\nimport { ImagePicker } from \"@/components/image-picker\";\r\n\r\ntype Project = {\r\n    id: number;\r\n    name: string;\r\n    location: string | null;\r\n    area: string | null;\r\n    type: string;\r\n    status: string;\r\n    customerId: number;\r\n    startDate: Date | string | null;\r\n    endDate: Date | string | null;\r\n    imageUrl: string | null;\r\n};\r\n\r\nexport function ProjectDialog({\r\n    project,\r\n    customers,\r\n    trigger,\r\n    mode = \"create\",\r\n    open: openProp,\r\n    onOpenChange: onOpenChangeProp,\r\n}: {\r\n    project?: Project;\r\n    customers: Customer[]; // Pass customers for dropdown\r\n    trigger?: React.ReactNode;\r\n    mode?: \"create\" | \"edit\";\r\n    open?: boolean;\r\n    onOpenChange?: (open: boolean) => void;\r\n}) {\r\n    const [internalOpen, setInternalOpen] = useState(false);\r\n\r\n    const isControlled = openProp !== undefined;\r\n    const open = isControlled ? openProp : internalOpen;\r\n    const setOpen = isControlled ? onOpenChangeProp! : setInternalOpen;\r\n\r\n    const [isPending, startTransition] = useTransition();\r\n\r\n    const [imageUrl, setImageUrl] = useState<string | null>(null);\r\n\r\n    // Helper to safely format date\r\n    const safeDate = (date: Date | string | null | undefined) => {\r\n        if (!date) return \"\";\r\n        try {\r\n            return new Date(date).toISOString().split('T')[0];\r\n        } catch (e) {\r\n            console.error(\"Invalid date:\", date);\r\n            return \"\";\r\n        }\r\n    };\r\n\r\n    // Initial form state (for controlled inputs excluding image)\r\n    const [formData, setFormData] = useState({\r\n        name: project?.name || \"\",\r\n        location: project?.location || \"\",\r\n        area: project?.area || \"\",\r\n        type: project?.type || \"Residential\",\r\n        status: project?.status || \"Planning\",\r\n        customerId: project?.customerId ? String(project.customerId) : \"\",\r\n        startDate: safeDate(project?.startDate),\r\n        endDate: safeDate(project?.endDate),\r\n    });\r\n\r\n    useEffect(() => {\r\n        if (project) {\r\n            setFormData({\r\n                name: project.name || \"\",\r\n                location: project.location || \"\",\r\n                area: project.area || \"\",\r\n                type: project.type || \"Residential\",\r\n                status: project.status || \"Planning\",\r\n                customerId: project.customerId ? String(project.customerId) : \"\",\r\n                startDate: safeDate(project.startDate),\r\n                endDate: safeDate(project.endDate),\r\n            });\r\n            setImageUrl(project.imageUrl || null);\r\n        } else {\r\n            // Reset if no project (create mode)\r\n            setFormData({\r\n                name: \"\", location: \"\", area: \"\", type: \"Residential\", status: \"Planning\", customerId: \"\", startDate: \"\", endDate: \"\"\r\n            });\r\n            setImageUrl(null);\r\n        }\r\n    }, [project]);\r\n\r\n\r\n    const handleSubmit = async (e: React.FormEvent) => {\r\n        e.preventDefault();\r\n        if (!formData.customerId) {\r\n            toast.error(\"Please select a customer\");\r\n            return;\r\n        }\r\n\r\n        startTransition(async () => {\r\n            const submissionData = new FormData();\r\n            submissionData.append(\"name\", formData.name);\r\n            if (formData.location) submissionData.append(\"location\", formData.location);\r\n            if (formData.area) submissionData.append(\"area\", formData.area);\r\n            submissionData.append(\"type\", formData.type);\r\n            submissionData.append(\"status\", formData.status);\r\n            submissionData.append(\"customerId\", formData.customerId);\r\n            if (formData.startDate) submissionData.append(\"startDate\", formData.startDate);\r\n            if (formData.endDate) submissionData.append(\"endDate\", formData.endDate);\r\n            if (imageUrl) submissionData.append(\"imageUrl\", imageUrl);\r\n\r\n            try {\r\n                if (mode === \"edit\" && project) {\r\n                    await updateProject(project.id, submissionData);\r\n                    toast.success(\"Project updated\");\r\n                } else {\r\n                    await createProject(submissionData);\r\n                    toast.success(\"Project created\");\r\n                }\r\n                setOpen(false);\r\n                if (mode === \"create\") {\r\n                    setFormData({\r\n                        name: \"\", location: \"\", area: \"\", type: \"Residential\", status: \"Planning\", customerId: \"\", startDate: \"\", endDate: \"\"\r\n                    });\r\n                    setImageUrl(null);\r\n                }\r\n            } catch (_) {\r\n                toast.error(\"An error occurred\");\r\n            }\r\n        });\r\n    };\r\n\r\n    // Old useEffect removed/merged above\r\n\r\n\r\n    return (\r\n        <Dialog open={open} onOpenChange={setOpen}>\r\n            <DialogTrigger asChild>\r\n                {trigger || (\r\n                    <Button>\r\n                        <Plus className=\"mr-2 h-4 w-4\" /> Add Project\r\n                    </Button>\r\n                )}\r\n            </DialogTrigger>\r\n            <DialogContent className=\"sm:max-w-[500px]\">\r\n                <DialogHeader>\r\n                    <DialogTitle>{mode === \"create\" ? \"Add Project\" : \"Edit Project\"}</DialogTitle>\r\n                </DialogHeader>\r\n                <div className=\"max-h-[80vh] overflow-y-auto pr-6 -mr-6 pl-1\">\r\n                    <form onSubmit={handleSubmit} className=\"space-y-4\">\r\n                        <ImagePicker\r\n                            label=\"Project Image\"\r\n                            value={imageUrl}\r\n                            onChange={setImageUrl}\r\n                            onRemove={() => setImageUrl(null)}\r\n                        />\r\n\r\n                        <div className=\"grid grid-cols-2 gap-4\">\r\n                            <div className=\"space-y-2 col-span-2\">\r\n                                <Label htmlFor={`name-${project?.id}`}>Project Name</Label>\r\n                                <Input\r\n                                    id={`name-${project?.id}`}\r\n                                    required\r\n                                    value={formData.name}\r\n                                    onChange={(e) => setFormData({ ...formData, name: e.target.value })}\r\n                                />\r\n                            </div>\r\n\r\n                            <div className=\"space-y-2 col-span-2\">\r\n                                <Label htmlFor={`area-${project?.id}`}>Building Area (sq ft)</Label>\r\n                                <Input\r\n                                    id={`area-${project?.id}`}\r\n                                    value={formData.area}\r\n                                    onChange={(e) => setFormData({ ...formData, area: e.target.value })}\r\n                                    placeholder=\"e.g. 1500 sq ft\"\r\n                                />\r\n                            </div>\r\n\r\n                            <div className=\"space-y-2\">\r\n                                <Label htmlFor={`type-${project?.id}`}>Type</Label>\r\n                                <Select value={formData.type} onValueChange={(val) => setFormData({ ...formData, type: val })}>\r\n                                    <SelectTrigger id={`type-${project?.id}`}>\r\n                                        <SelectValue placeholder=\"Select type\" />\r\n                                    </SelectTrigger>\r\n                                    <SelectContent>\r\n                                        <SelectItem value=\"Residential\">Residential</SelectItem>\r\n                                        <SelectItem value=\"Commercial\">Commercial</SelectItem>\r\n                                        <SelectItem value=\"Industrial\">Industrial</SelectItem>\r\n                                    </SelectContent>\r\n                                </Select>\r\n                            </div>\r\n                            <div className=\"space-y-2\">\r\n                                <Label htmlFor={`status-${project?.id}`}>Status</Label>\r\n                                <Select value={formData.status} onValueChange={(val) => setFormData({ ...formData, status: val })}>\r\n                                    <SelectTrigger id={`status-${project?.id}`}>\r\n                                        <SelectValue placeholder=\"Select status\" />\r\n                                    </SelectTrigger>\r\n                                    <SelectContent>\r\n                                        <SelectItem value=\"Planning\">Planning</SelectItem>\r\n                                        <SelectItem value=\"Ongoing\">Ongoing</SelectItem>\r\n                                        <SelectItem value=\"Completed\">Completed</SelectItem>\r\n                                        <SelectItem value=\"On Hold\">On Hold</SelectItem>\r\n                                    </SelectContent>\r\n                                </Select>\r\n                            </div>\r\n\r\n                            <div className=\"space-y-2 col-span-2\">\r\n                                <Label htmlFor={`customer-${project?.id}`}>Customer</Label>\r\n                                <Select value={formData.customerId} onValueChange={(val) => setFormData({ ...formData, customerId: val })}>\r\n                                    <SelectTrigger id={`customer-${project?.id}`}>\r\n                                        <SelectValue placeholder=\"Select customer\" />\r\n                                    </SelectTrigger>\r\n                                    <SelectContent>\r\n                                        {customers.map(c => (\r\n                                            <SelectItem key={c.id} value={String(c.id)}>{c.name}</SelectItem>\r\n                                        ))}\r\n                                    </SelectContent>\r\n                                </Select>\r\n                            </div>\r\n\r\n                            <div className=\"space-y-2 col-span-2\">\r\n                                <Label htmlFor={`location-${project?.id}`}>Location</Label>\r\n                                <Input\r\n                                    id={`location-${project?.id}`}\r\n                                    value={formData.location}\r\n                                    onChange={(e) => setFormData({ ...formData, location: e.target.value })}\r\n                                />\r\n                            </div>\r\n\r\n                            <div className=\"space-y-2\">\r\n                                <Label htmlFor={`startDate-${project?.id}`}>Start Date</Label>\r\n                                <Input\r\n                                    id={`startDate-${project?.id}`}\r\n                                    type=\"date\"\r\n                                    value={formData.startDate}\r\n                                    onChange={(e) => setFormData({ ...formData, startDate: e.target.value })}\r\n                                />\r\n                            </div>\r\n                            <div className=\"space-y-2\">\r\n                                <Label htmlFor={`endDate-${project?.id}`}>End Date</Label>\r\n                                <Input\r\n                                    id={`endDate-${project?.id}`}\r\n                                    type=\"date\"\r\n                                    value={formData.endDate}\r\n                                    onChange={(e) => setFormData({ ...formData, endDate: e.target.value })}\r\n                                />\r\n                            </div>\r\n                        </div>\r\n\r\n                        <DialogFooter className=\"pt-4\">\r\n                            <Button type=\"submit\" disabled={isPending}>\r\n                                {isPending && <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />}\r\n                                {mode === \"create\" ? \"Create\" : \"Save Changes\"}\r\n                            </Button>\r\n                        </DialogFooter>\r\n                    </form>\r\n                </div>\r\n            </DialogContent>\r\n        </Dialog>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\gemini antigravity works\\Construction app\\src\\components\\project-gallery.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Card' is defined but never used.","line":5,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":5,"endColumn":14},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CardContent' is defined but never used.","line":5,"column":16,"nodeType":null,"messageId":"unusedVar","endLine":5,"endColumn":27},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'X' is defined but never used.","line":6,"column":18,"nodeType":null,"messageId":"unusedVar","endLine":6,"endColumn":19},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'isDeleting' is assigned a value but never used.","line":32,"column":12,"nodeType":null,"messageId":"unusedVar","endLine":32,"endColumn":22},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'formData' is assigned a value but never used.","line":39,"column":15,"nodeType":null,"messageId":"unusedVar","endLine":39,"endColumn":23}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useState, useRef, useTransition } from \"react\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Card, CardContent } from \"@/components/ui/card\";\r\nimport { Upload, X, Loader2, Trash2 } from \"lucide-react\";\r\nimport Image from \"next/image\";\r\nimport { uploadImage } from \"@/actions/upload\";\r\nimport { addProjectImage, deleteProjectImage } from \"@/actions/project\";\r\nimport { toast } from \"sonner\";\r\nimport {\r\n    AlertDialog,\r\n    AlertDialogAction,\r\n    AlertDialogCancel,\r\n    AlertDialogContent,\r\n    AlertDialogDescription,\r\n    AlertDialogFooter,\r\n    AlertDialogHeader,\r\n    AlertDialogTitle,\r\n    AlertDialogTrigger,\r\n} from \"@/components/ui/alert-dialog\";\r\n\r\ntype ProjectImage = {\r\n    id: number;\r\n    url: string;\r\n    projectId: number;\r\n};\r\n\r\nexport function ProjectGallery({ projectId, images }: { projectId: number; images: ProjectImage[] }) {\r\n    const fileInputRef = useRef<HTMLInputElement>(null);\r\n    const [isUploading, setIsUploading] = useState(false);\r\n    const [isDeleting, startTransition] = useTransition();\r\n\r\n    const handleFileChange = async (e: React.ChangeEvent<HTMLInputElement>) => {\r\n        const files = e.target.files;\r\n        if (!files || files.length === 0) return;\r\n\r\n        setIsUploading(true);\r\n        const formData = new FormData();\r\n\r\n        // Upload each file\r\n        for (let i = 0; i < files.length; i++) {\r\n            const file = files[i];\r\n            if (!file.type.startsWith(\"image/\")) continue;\r\n\r\n            const uploadData = new FormData();\r\n            uploadData.append(\"file\", file);\r\n\r\n            try {\r\n                const result = await uploadImage(uploadData);\r\n                if (result.url) {\r\n                    await addProjectImage(projectId, result.url);\r\n                }\r\n            } catch (error) {\r\n                console.error(\"Upload failed\", error);\r\n                toast.error(\"Failed to upload an image\");\r\n            }\r\n        }\r\n\r\n        setIsUploading(false);\r\n        if (fileInputRef.current) fileInputRef.current.value = \"\";\r\n        toast.success(\"Images uploaded\");\r\n    };\r\n\r\n    const handleDelete = (imageId: number) => {\r\n        startTransition(async () => {\r\n            try {\r\n                await deleteProjectImage(imageId);\r\n                toast.success(\"Image deleted\");\r\n            } catch {\r\n                toast.error(\"Failed to delete image\");\r\n            }\r\n        });\r\n    };\r\n\r\n    return (\r\n        <div className=\"space-y-6\">\r\n            <div className=\"flex justify-between items-center\">\r\n                <h3 className=\"text-lg font-medium\">Project Gallery</h3>\r\n                <div>\r\n                    <Button onClick={() => fileInputRef.current?.click()} disabled={isUploading}>\r\n                        {isUploading ? <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" /> : <Upload className=\"mr-2 h-4 w-4\" />}\r\n                        Upload Images\r\n                    </Button>\r\n                    <input\r\n                        type=\"file\"\r\n                        multiple\r\n                        className=\"hidden\"\r\n                        ref={fileInputRef}\r\n                        accept=\"image/*\"\r\n                        onChange={handleFileChange}\r\n                    />\r\n                </div>\r\n            </div>\r\n\r\n            {images.length === 0 ? (\r\n                <div className=\"text-center py-12 border-2 border-dashed rounded-lg border-zinc-200 dark:border-zinc-800\">\r\n                    <p className=\"text-zinc-500\">No images uploaded yet.</p>\r\n                </div>\r\n            ) : (\r\n                <div className=\"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4\">\r\n                    {images.map((img) => (\r\n                        <div key={img.id} className=\"group relative aspect-square rounded-lg overflow-hidden border bg-zinc-100\">\r\n                            <Image\r\n                                src={img.url}\r\n                                alt=\"Project Image\"\r\n                                fill\r\n                                className=\"object-cover\"\r\n                            />\r\n                            <div className=\"absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center\">\r\n                                <AlertDialog>\r\n                                    <AlertDialogTrigger asChild>\r\n                                        <Button variant=\"destructive\" size=\"icon\">\r\n                                            <Trash2 className=\"h-4 w-4\" />\r\n                                        </Button>\r\n                                    </AlertDialogTrigger>\r\n                                    <AlertDialogContent>\r\n                                        <AlertDialogHeader>\r\n                                            <AlertDialogTitle>Delete Image?</AlertDialogTitle>\r\n                                            <AlertDialogDescription>\r\n                                                This cannot be undone.\r\n                                            </AlertDialogDescription>\r\n                                        </AlertDialogHeader>\r\n                                        <AlertDialogFooter>\r\n                                            <AlertDialogCancel>Cancel</AlertDialogCancel>\r\n                                            <AlertDialogAction onClick={() => handleDelete(img.id)}>Delete</AlertDialogAction>\r\n                                        </AlertDialogFooter>\r\n                                    </AlertDialogContent>\r\n                                </AlertDialog>\r\n                            </div>\r\n                        </div>\r\n                    ))}\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\gemini antigravity works\\Construction app\\src\\components\\project-worker-manager.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'_' is defined but never used.","line":53,"column":22,"nodeType":null,"messageId":"unusedVar","endLine":53,"endColumn":23},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'_' is defined but never used.","line":65,"column":22,"nodeType":null,"messageId":"unusedVar","endLine":65,"endColumn":23}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useState, useTransition } from \"react\";\r\nimport { assignWorkerToProject, removeWorkerFromProject } from \"@/actions/worker\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport {\r\n    Dialog,\r\n    DialogContent,\r\n    DialogHeader,\r\n    DialogTitle,\r\n    DialogTrigger,\r\n} from \"@/components/ui/dialog\";\r\nimport {\r\n    Select,\r\n    SelectContent,\r\n    SelectItem,\r\n    SelectTrigger,\r\n    SelectValue,\r\n} from \"@/components/ui/select\";\r\nimport { toast } from \"sonner\";\r\nimport { Plus, X } from \"lucide-react\";\r\n\r\ntype Worker = {\r\n    id: number;\r\n    name: string;\r\n    role: string;\r\n};\r\n\r\nexport function ProjectWorkerManager({\r\n    projectId,\r\n    assignedWorkers,\r\n    allWorkers\r\n}: {\r\n    projectId: number,\r\n    assignedWorkers: Worker[],\r\n    allWorkers: Worker[]\r\n}) {\r\n    const [open, setOpen] = useState(false);\r\n    const [selectedWorkerId, setSelectedWorkerId] = useState(\"\");\r\n    const [isPending, startTransition] = useTransition();\r\n\r\n    // Filter out workers already assigned\r\n    const availableWorkers = allWorkers.filter(w => !assignedWorkers.some(aw => aw.id === w.id));\r\n\r\n    const handleAssign = () => {\r\n        if (!selectedWorkerId) return;\r\n        startTransition(async () => {\r\n            try {\r\n                await assignWorkerToProject(parseInt(selectedWorkerId), projectId);\r\n                toast.success(\"Worker assigned\");\r\n                setOpen(false);\r\n                setSelectedWorkerId(\"\");\r\n            } catch (_) {\r\n                toast.error(\"Failed to assign worker\");\r\n            }\r\n        });\r\n    };\r\n\r\n    const handleRemove = (workerId: number) => {\r\n        if (!confirm(\"Remove this worker from the project?\")) return;\r\n        startTransition(async () => {\r\n            try {\r\n                await removeWorkerFromProject(workerId, projectId);\r\n                toast.success(\"Worker removed\");\r\n            } catch (_) {\r\n                toast.error(\"Failed to remove worker\");\r\n            }\r\n        });\r\n    };\r\n\r\n    return (\r\n        <div className=\"space-y-4\">\r\n            <div className=\"flex justify-end\">\r\n                <Dialog open={open} onOpenChange={setOpen}>\r\n                    <DialogTrigger asChild>\r\n                        <Button variant=\"outline\" size=\"sm\">\r\n                            <Plus className=\"mr-2 h-4 w-4\" /> Assign Worker\r\n                        </Button>\r\n                    </DialogTrigger>\r\n                    <DialogContent className=\"sm:max-w-[400px]\">\r\n                        <DialogHeader>\r\n                            <DialogTitle>Assign Worker to Project</DialogTitle>\r\n                        </DialogHeader>\r\n                        <div className=\"space-y-4 py-4\">\r\n                            <Select value={selectedWorkerId} onValueChange={setSelectedWorkerId}>\r\n                                <SelectTrigger>\r\n                                    <SelectValue placeholder=\"Select a worker\" />\r\n                                </SelectTrigger>\r\n                                <SelectContent>\r\n                                    {availableWorkers.map(w => (\r\n                                        <SelectItem key={w.id} value={String(w.id)}>\r\n                                            {w.name} ({w.role})\r\n                                        </SelectItem>\r\n                                    ))}\r\n                                    {availableWorkers.length === 0 && (\r\n                                        <SelectItem value=\"none\" disabled>No available workers</SelectItem>\r\n                                    )}\r\n                                </SelectContent>\r\n                            </Select>\r\n                            <Button onClick={handleAssign} disabled={!selectedWorkerId || isPending} className=\"w-full\">\r\n                                {isPending ? \"Assigning...\" : \"Assign\"}\r\n                            </Button>\r\n                        </div>\r\n                    </DialogContent>\r\n                </Dialog>\r\n            </div>\r\n\r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\r\n                {assignedWorkers.map(worker => (\r\n                    <div key={worker.id} className=\"flex items-center justify-between p-4 bg-white dark:bg-zinc-800 rounded-lg border border-zinc-200 dark:border-zinc-700\">\r\n                        <div>\r\n                            <p className=\"font-medium text-sm\">{worker.name}</p>\r\n                            <p className=\"text-xs text-zinc-500\">{worker.role}</p>\r\n                        </div>\r\n                        <Button\r\n                            variant=\"ghost\"\r\n                            size=\"icon\"\r\n                            className=\"text-zinc-500 hover:text-red-500\"\r\n                            onClick={() => handleRemove(worker.id)}\r\n                            disabled={isPending}\r\n                        >\r\n                            <X className=\"h-4 w-4\" />\r\n                        </Button>\r\n                    </div>\r\n                ))}\r\n                {assignedWorkers.length === 0 && (\r\n                    <div className=\"col-span-full border-2 border-dashed rounded-lg p-6 text-center text-zinc-500\">\r\n                        No workers assigned to this project.\r\n                    </div>\r\n                )}\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\gemini antigravity works\\Construction app\\src\\components\\projects-table.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\gemini antigravity works\\Construction app\\src\\components\\ui\\alert-dialog.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\gemini antigravity works\\Construction app\\src\\components\\ui\\avatar.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\gemini antigravity works\\Construction app\\src\\components\\ui\\badge.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\gemini antigravity works\\Construction app\\src\\components\\ui\\button.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\gemini antigravity works\\Construction app\\src\\components\\ui\\calendar.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\gemini antigravity works\\Construction app\\src\\components\\ui\\card.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\gemini antigravity works\\Construction app\\src\\components\\ui\\dialog.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\gemini antigravity works\\Construction app\\src\\components\\ui\\error-boundary.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\gemini antigravity works\\Construction app\\src\\components\\ui\\input.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\gemini antigravity works\\Construction app\\src\\components\\ui\\label.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\gemini antigravity works\\Construction app\\src\\components\\ui\\popover.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\gemini antigravity works\\Construction app\\src\\components\\ui\\select.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\gemini antigravity works\\Construction app\\src\\components\\ui\\separator.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\gemini antigravity works\\Construction app\\src\\components\\ui\\sheet.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\gemini antigravity works\\Construction app\\src\\components\\ui\\sidebar.tsx","messages":[{"ruleId":"react-hooks/purity","severity":2,"message":"Error: Cannot call impure function during render\n\n`Math.random` is an impure function. Calling an impure function can produce unstable results that update unpredictably when the component happens to re-render. (https://react.dev/reference/rules/components-and-hooks-must-be-pure#components-and-hooks-must-be-idempotent).\n\nD:\\gemini antigravity works\\Construction app\\src\\components\\ui\\sidebar.tsx:611:26\n  609 |   // Random width between 50 to 90%.\n  610 |   const width = React.useMemo(() => {\n> 611 |     return `${Math.floor(Math.random() * 40) + 50}%`\n      |                          ^^^^^^^^^^^^^ Cannot call impure function\n  612 |   }, [])\n  613 |\n  614 |   return (","line":611,"column":26,"nodeType":null,"endLine":611,"endColumn":39}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\"\n\nimport * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\nimport { PanelLeftIcon } from \"lucide-react\"\n\nimport { useIsMobile } from \"@/hooks/use-mobile\"\nimport { cn } from \"@/lib/utils\"\nimport { Button } from \"@/components/ui/button\"\nimport { Input } from \"@/components/ui/input\"\nimport { Separator } from \"@/components/ui/separator\"\nimport {\n  Sheet,\n  SheetContent,\n  SheetDescription,\n  SheetHeader,\n  SheetTitle,\n} from \"@/components/ui/sheet\"\nimport { Skeleton } from \"@/components/ui/skeleton\"\nimport {\n  Tooltip,\n  TooltipContent,\n  TooltipProvider,\n  TooltipTrigger,\n} from \"@/components/ui/tooltip\"\n\nconst SIDEBAR_COOKIE_NAME = \"sidebar_state\"\nconst SIDEBAR_COOKIE_MAX_AGE = 60 * 60 * 24 * 7\nconst SIDEBAR_WIDTH = \"16rem\"\nconst SIDEBAR_WIDTH_MOBILE = \"18rem\"\nconst SIDEBAR_WIDTH_ICON = \"3rem\"\nconst SIDEBAR_KEYBOARD_SHORTCUT = \"b\"\n\ntype SidebarContextProps = {\n  state: \"expanded\" | \"collapsed\"\n  open: boolean\n  setOpen: (open: boolean) => void\n  openMobile: boolean\n  setOpenMobile: (open: boolean) => void\n  isMobile: boolean\n  toggleSidebar: () => void\n}\n\nconst SidebarContext = React.createContext<SidebarContextProps | null>(null)\n\nfunction useSidebar() {\n  const context = React.useContext(SidebarContext)\n  if (!context) {\n    throw new Error(\"useSidebar must be used within a SidebarProvider.\")\n  }\n\n  return context\n}\n\nfunction SidebarProvider({\n  defaultOpen = true,\n  open: openProp,\n  onOpenChange: setOpenProp,\n  className,\n  style,\n  children,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  defaultOpen?: boolean\n  open?: boolean\n  onOpenChange?: (open: boolean) => void\n}) {\n  const isMobile = useIsMobile()\n  const [openMobile, setOpenMobile] = React.useState(false)\n\n  // This is the internal state of the sidebar.\n  // We use openProp and setOpenProp for control from outside the component.\n  const [_open, _setOpen] = React.useState(defaultOpen)\n  const open = openProp ?? _open\n  const setOpen = React.useCallback(\n    (value: boolean | ((value: boolean) => boolean)) => {\n      const openState = typeof value === \"function\" ? value(open) : value\n      if (setOpenProp) {\n        setOpenProp(openState)\n      } else {\n        _setOpen(openState)\n      }\n\n      // This sets the cookie to keep the sidebar state.\n      document.cookie = `${SIDEBAR_COOKIE_NAME}=${openState}; path=/; max-age=${SIDEBAR_COOKIE_MAX_AGE}`\n    },\n    [setOpenProp, open]\n  )\n\n  // Helper to toggle the sidebar.\n  const toggleSidebar = React.useCallback(() => {\n    return isMobile ? setOpenMobile((open) => !open) : setOpen((open) => !open)\n  }, [isMobile, setOpen, setOpenMobile])\n\n  // Adds a keyboard shortcut to toggle the sidebar.\n  React.useEffect(() => {\n    const handleKeyDown = (event: KeyboardEvent) => {\n      if (\n        event.key === SIDEBAR_KEYBOARD_SHORTCUT &&\n        (event.metaKey || event.ctrlKey)\n      ) {\n        event.preventDefault()\n        toggleSidebar()\n      }\n    }\n\n    window.addEventListener(\"keydown\", handleKeyDown)\n    return () => window.removeEventListener(\"keydown\", handleKeyDown)\n  }, [toggleSidebar])\n\n  // We add a state so that we can do data-state=\"expanded\" or \"collapsed\".\n  // This makes it easier to style the sidebar with Tailwind classes.\n  const state = open ? \"expanded\" : \"collapsed\"\n\n  const contextValue = React.useMemo<SidebarContextProps>(\n    () => ({\n      state,\n      open,\n      setOpen,\n      isMobile,\n      openMobile,\n      setOpenMobile,\n      toggleSidebar,\n    }),\n    [state, open, setOpen, isMobile, openMobile, setOpenMobile, toggleSidebar]\n  )\n\n  return (\n    <SidebarContext.Provider value={contextValue}>\n      <TooltipProvider delayDuration={0}>\n        <div\n          data-slot=\"sidebar-wrapper\"\n          style={\n            {\n              \"--sidebar-width\": SIDEBAR_WIDTH,\n              \"--sidebar-width-icon\": SIDEBAR_WIDTH_ICON,\n              ...style,\n            } as React.CSSProperties\n          }\n          className={cn(\n            \"group/sidebar-wrapper has-data-[variant=inset]:bg-sidebar flex min-h-svh w-full\",\n            className\n          )}\n          {...props}\n        >\n          {children}\n        </div>\n      </TooltipProvider>\n    </SidebarContext.Provider>\n  )\n}\n\nfunction Sidebar({\n  side = \"left\",\n  variant = \"sidebar\",\n  collapsible = \"offcanvas\",\n  className,\n  children,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  side?: \"left\" | \"right\"\n  variant?: \"sidebar\" | \"floating\" | \"inset\"\n  collapsible?: \"offcanvas\" | \"icon\" | \"none\"\n}) {\n  const { isMobile, state, openMobile, setOpenMobile } = useSidebar()\n\n  if (collapsible === \"none\") {\n    return (\n      <div\n        data-slot=\"sidebar\"\n        className={cn(\n          \"bg-sidebar text-sidebar-foreground flex h-full w-(--sidebar-width) flex-col\",\n          className\n        )}\n        {...props}\n      >\n        {children}\n      </div>\n    )\n  }\n\n  if (isMobile) {\n    return (\n      <Sheet open={openMobile} onOpenChange={setOpenMobile} {...props}>\n        <SheetContent\n          data-sidebar=\"sidebar\"\n          data-slot=\"sidebar\"\n          data-mobile=\"true\"\n          className=\"bg-sidebar text-sidebar-foreground w-(--sidebar-width) p-0 [&>button]:hidden\"\n          style={\n            {\n              \"--sidebar-width\": SIDEBAR_WIDTH_MOBILE,\n            } as React.CSSProperties\n          }\n          side={side}\n        >\n          <SheetHeader className=\"sr-only\">\n            <SheetTitle>Sidebar</SheetTitle>\n            <SheetDescription>Displays the mobile sidebar.</SheetDescription>\n          </SheetHeader>\n          <div className=\"flex h-full w-full flex-col\">{children}</div>\n        </SheetContent>\n      </Sheet>\n    )\n  }\n\n  return (\n    <div\n      className=\"group peer text-sidebar-foreground hidden md:block\"\n      data-state={state}\n      data-collapsible={state === \"collapsed\" ? collapsible : \"\"}\n      data-variant={variant}\n      data-side={side}\n      data-slot=\"sidebar\"\n    >\n      {/* This is what handles the sidebar gap on desktop */}\n      <div\n        data-slot=\"sidebar-gap\"\n        className={cn(\n          \"relative w-(--sidebar-width) bg-transparent transition-[width] duration-200 ease-linear\",\n          \"group-data-[collapsible=offcanvas]:w-0\",\n          \"group-data-[side=right]:rotate-180\",\n          variant === \"floating\" || variant === \"inset\"\n            ? \"group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)+(--spacing(4)))]\"\n            : \"group-data-[collapsible=icon]:w-(--sidebar-width-icon)\"\n        )}\n      />\n      <div\n        data-slot=\"sidebar-container\"\n        className={cn(\n          \"fixed inset-y-0 z-10 hidden h-svh w-(--sidebar-width) transition-[left,right,width] duration-200 ease-linear md:flex\",\n          side === \"left\"\n            ? \"left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)]\"\n            : \"right-0 group-data-[collapsible=offcanvas]:right-[calc(var(--sidebar-width)*-1)]\",\n          // Adjust the padding for floating and inset variants.\n          variant === \"floating\" || variant === \"inset\"\n            ? \"p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)+(--spacing(4))+2px)]\"\n            : \"group-data-[collapsible=icon]:w-(--sidebar-width-icon) group-data-[side=left]:border-r group-data-[side=right]:border-l\",\n          className\n        )}\n        {...props}\n      >\n        <div\n          data-sidebar=\"sidebar\"\n          data-slot=\"sidebar-inner\"\n          className=\"bg-sidebar group-data-[variant=floating]:border-sidebar-border flex h-full w-full flex-col group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:shadow-sm\"\n        >\n          {children}\n        </div>\n      </div>\n    </div>\n  )\n}\n\nfunction SidebarTrigger({\n  className,\n  onClick,\n  ...props\n}: React.ComponentProps<typeof Button>) {\n  const { toggleSidebar } = useSidebar()\n\n  return (\n    <Button\n      data-sidebar=\"trigger\"\n      data-slot=\"sidebar-trigger\"\n      variant=\"ghost\"\n      size=\"icon\"\n      className={cn(\"size-7\", className)}\n      onClick={(event) => {\n        onClick?.(event)\n        toggleSidebar()\n      }}\n      {...props}\n    >\n      <PanelLeftIcon />\n      <span className=\"sr-only\">Toggle Sidebar</span>\n    </Button>\n  )\n}\n\nfunction SidebarRail({ className, ...props }: React.ComponentProps<\"button\">) {\n  const { toggleSidebar } = useSidebar()\n\n  return (\n    <button\n      data-sidebar=\"rail\"\n      data-slot=\"sidebar-rail\"\n      aria-label=\"Toggle Sidebar\"\n      tabIndex={-1}\n      onClick={toggleSidebar}\n      title=\"Toggle Sidebar\"\n      className={cn(\n        \"hover:after:bg-sidebar-border absolute inset-y-0 z-20 hidden w-4 -translate-x-1/2 transition-all ease-linear group-data-[side=left]:-right-4 group-data-[side=right]:left-0 after:absolute after:inset-y-0 after:left-1/2 after:w-[2px] sm:flex\",\n        \"in-data-[side=left]:cursor-w-resize in-data-[side=right]:cursor-e-resize\",\n        \"[[data-side=left][data-state=collapsed]_&]:cursor-e-resize [[data-side=right][data-state=collapsed]_&]:cursor-w-resize\",\n        \"hover:group-data-[collapsible=offcanvas]:bg-sidebar group-data-[collapsible=offcanvas]:translate-x-0 group-data-[collapsible=offcanvas]:after:left-full\",\n        \"[[data-side=left][data-collapsible=offcanvas]_&]:-right-2\",\n        \"[[data-side=right][data-collapsible=offcanvas]_&]:-left-2\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarInset({ className, ...props }: React.ComponentProps<\"main\">) {\n  return (\n    <main\n      data-slot=\"sidebar-inset\"\n      className={cn(\n        \"bg-background relative flex w-full flex-1 flex-col\",\n        \"md:peer-data-[variant=inset]:m-2 md:peer-data-[variant=inset]:ml-0 md:peer-data-[variant=inset]:rounded-xl md:peer-data-[variant=inset]:shadow-sm md:peer-data-[variant=inset]:peer-data-[state=collapsed]:ml-2\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarInput({\n  className,\n  ...props\n}: React.ComponentProps<typeof Input>) {\n  return (\n    <Input\n      data-slot=\"sidebar-input\"\n      data-sidebar=\"input\"\n      className={cn(\"bg-background h-8 w-full shadow-none\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarHeader({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-header\"\n      data-sidebar=\"header\"\n      className={cn(\"flex flex-col gap-2 p-2\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarFooter({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-footer\"\n      data-sidebar=\"footer\"\n      className={cn(\"flex flex-col gap-2 p-2\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarSeparator({\n  className,\n  ...props\n}: React.ComponentProps<typeof Separator>) {\n  return (\n    <Separator\n      data-slot=\"sidebar-separator\"\n      data-sidebar=\"separator\"\n      className={cn(\"bg-sidebar-border mx-2 w-auto\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarContent({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-content\"\n      data-sidebar=\"content\"\n      className={cn(\n        \"flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroup({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-group\"\n      data-sidebar=\"group\"\n      className={cn(\"relative flex w-full min-w-0 flex-col p-2\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroupLabel({\n  className,\n  asChild = false,\n  ...props\n}: React.ComponentProps<\"div\"> & { asChild?: boolean }) {\n  const Comp = asChild ? Slot : \"div\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-group-label\"\n      data-sidebar=\"group-label\"\n      className={cn(\n        \"text-sidebar-foreground/70 ring-sidebar-ring flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium outline-hidden transition-[margin,opacity] duration-200 ease-linear focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0\",\n        \"group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroupAction({\n  className,\n  asChild = false,\n  ...props\n}: React.ComponentProps<\"button\"> & { asChild?: boolean }) {\n  const Comp = asChild ? Slot : \"button\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-group-action\"\n      data-sidebar=\"group-action\"\n      className={cn(\n        \"text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground absolute top-3.5 right-3 flex aspect-square w-5 items-center justify-center rounded-md p-0 outline-hidden transition-transform focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0\",\n        // Increases the hit area of the button on mobile.\n        \"after:absolute after:-inset-2 md:after:hidden\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroupContent({\n  className,\n  ...props\n}: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-group-content\"\n      data-sidebar=\"group-content\"\n      className={cn(\"w-full text-sm\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenu({ className, ...props }: React.ComponentProps<\"ul\">) {\n  return (\n    <ul\n      data-slot=\"sidebar-menu\"\n      data-sidebar=\"menu\"\n      className={cn(\"flex w-full min-w-0 flex-col gap-1\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuItem({ className, ...props }: React.ComponentProps<\"li\">) {\n  return (\n    <li\n      data-slot=\"sidebar-menu-item\"\n      data-sidebar=\"menu-item\"\n      className={cn(\"group/menu-item relative\", className)}\n      {...props}\n    />\n  )\n}\n\nconst sidebarMenuButtonVariants = cva(\n  \"peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left text-sm outline-hidden ring-sidebar-ring transition-[width,height,padding] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-data-[sidebar=menu-action]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:size-8! group-data-[collapsible=icon]:p-2! [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0\",\n  {\n    variants: {\n      variant: {\n        default: \"hover:bg-sidebar-accent hover:text-sidebar-accent-foreground\",\n        outline:\n          \"bg-background shadow-[0_0_0_1px_hsl(var(--sidebar-border))] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground hover:shadow-[0_0_0_1px_hsl(var(--sidebar-accent))]\",\n      },\n      size: {\n        default: \"h-8 text-sm\",\n        sm: \"h-7 text-xs\",\n        lg: \"h-12 text-sm group-data-[collapsible=icon]:p-0!\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nfunction SidebarMenuButton({\n  asChild = false,\n  isActive = false,\n  variant = \"default\",\n  size = \"default\",\n  tooltip,\n  className,\n  ...props\n}: React.ComponentProps<\"button\"> & {\n  asChild?: boolean\n  isActive?: boolean\n  tooltip?: string | React.ComponentProps<typeof TooltipContent>\n} & VariantProps<typeof sidebarMenuButtonVariants>) {\n  const Comp = asChild ? Slot : \"button\"\n  const { isMobile, state } = useSidebar()\n\n  const button = (\n    <Comp\n      data-slot=\"sidebar-menu-button\"\n      data-sidebar=\"menu-button\"\n      data-size={size}\n      data-active={isActive}\n      className={cn(sidebarMenuButtonVariants({ variant, size }), className)}\n      {...props}\n    />\n  )\n\n  if (!tooltip) {\n    return button\n  }\n\n  if (typeof tooltip === \"string\") {\n    tooltip = {\n      children: tooltip,\n    }\n  }\n\n  return (\n    <Tooltip>\n      <TooltipTrigger asChild>{button}</TooltipTrigger>\n      <TooltipContent\n        side=\"right\"\n        align=\"center\"\n        hidden={state !== \"collapsed\" || isMobile}\n        {...tooltip}\n      />\n    </Tooltip>\n  )\n}\n\nfunction SidebarMenuAction({\n  className,\n  asChild = false,\n  showOnHover = false,\n  ...props\n}: React.ComponentProps<\"button\"> & {\n  asChild?: boolean\n  showOnHover?: boolean\n}) {\n  const Comp = asChild ? Slot : \"button\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-menu-action\"\n      data-sidebar=\"menu-action\"\n      className={cn(\n        \"text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground peer-hover/menu-button:text-sidebar-accent-foreground absolute top-1.5 right-1 flex aspect-square w-5 items-center justify-center rounded-md p-0 outline-hidden transition-transform focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0\",\n        // Increases the hit area of the button on mobile.\n        \"after:absolute after:-inset-2 md:after:hidden\",\n        \"peer-data-[size=sm]/menu-button:top-1\",\n        \"peer-data-[size=default]/menu-button:top-1.5\",\n        \"peer-data-[size=lg]/menu-button:top-2.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        showOnHover &&\n          \"peer-data-[active=true]/menu-button:text-sidebar-accent-foreground group-focus-within/menu-item:opacity-100 group-hover/menu-item:opacity-100 data-[state=open]:opacity-100 md:opacity-0\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuBadge({\n  className,\n  ...props\n}: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-menu-badge\"\n      data-sidebar=\"menu-badge\"\n      className={cn(\n        \"text-sidebar-foreground pointer-events-none absolute right-1 flex h-5 min-w-5 items-center justify-center rounded-md px-1 text-xs font-medium tabular-nums select-none\",\n        \"peer-hover/menu-button:text-sidebar-accent-foreground peer-data-[active=true]/menu-button:text-sidebar-accent-foreground\",\n        \"peer-data-[size=sm]/menu-button:top-1\",\n        \"peer-data-[size=default]/menu-button:top-1.5\",\n        \"peer-data-[size=lg]/menu-button:top-2.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuSkeleton({\n  className,\n  showIcon = false,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  showIcon?: boolean\n}) {\n  // Random width between 50 to 90%.\n  const width = React.useMemo(() => {\n    return `${Math.floor(Math.random() * 40) + 50}%`\n  }, [])\n\n  return (\n    <div\n      data-slot=\"sidebar-menu-skeleton\"\n      data-sidebar=\"menu-skeleton\"\n      className={cn(\"flex h-8 items-center gap-2 rounded-md px-2\", className)}\n      {...props}\n    >\n      {showIcon && (\n        <Skeleton\n          className=\"size-4 rounded-md\"\n          data-sidebar=\"menu-skeleton-icon\"\n        />\n      )}\n      <Skeleton\n        className=\"h-4 max-w-(--skeleton-width) flex-1\"\n        data-sidebar=\"menu-skeleton-text\"\n        style={\n          {\n            \"--skeleton-width\": width,\n          } as React.CSSProperties\n        }\n      />\n    </div>\n  )\n}\n\nfunction SidebarMenuSub({ className, ...props }: React.ComponentProps<\"ul\">) {\n  return (\n    <ul\n      data-slot=\"sidebar-menu-sub\"\n      data-sidebar=\"menu-sub\"\n      className={cn(\n        \"border-sidebar-border mx-3.5 flex min-w-0 translate-x-px flex-col gap-1 border-l px-2.5 py-0.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuSubItem({\n  className,\n  ...props\n}: React.ComponentProps<\"li\">) {\n  return (\n    <li\n      data-slot=\"sidebar-menu-sub-item\"\n      data-sidebar=\"menu-sub-item\"\n      className={cn(\"group/menu-sub-item relative\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuSubButton({\n  asChild = false,\n  size = \"md\",\n  isActive = false,\n  className,\n  ...props\n}: React.ComponentProps<\"a\"> & {\n  asChild?: boolean\n  size?: \"sm\" | \"md\"\n  isActive?: boolean\n}) {\n  const Comp = asChild ? Slot : \"a\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-menu-sub-button\"\n      data-sidebar=\"menu-sub-button\"\n      data-size={size}\n      data-active={isActive}\n      className={cn(\n        \"text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground active:bg-sidebar-accent active:text-sidebar-accent-foreground [&>svg]:text-sidebar-accent-foreground flex h-7 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 outline-hidden focus-visible:ring-2 disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0\",\n        \"data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground\",\n        size === \"sm\" && \"text-xs\",\n        size === \"md\" && \"text-sm\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport {\n  Sidebar,\n  SidebarContent,\n  SidebarFooter,\n  SidebarGroup,\n  SidebarGroupAction,\n  SidebarGroupContent,\n  SidebarGroupLabel,\n  SidebarHeader,\n  SidebarInput,\n  SidebarInset,\n  SidebarMenu,\n  SidebarMenuAction,\n  SidebarMenuBadge,\n  SidebarMenuButton,\n  SidebarMenuItem,\n  SidebarMenuSkeleton,\n  SidebarMenuSub,\n  SidebarMenuSubButton,\n  SidebarMenuSubItem,\n  SidebarProvider,\n  SidebarRail,\n  SidebarSeparator,\n  SidebarTrigger,\n  useSidebar,\n}\n","usedDeprecatedRules":[]},{"filePath":"D:\\gemini antigravity works\\Construction app\\src\\components\\ui\\skeleton.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\gemini antigravity works\\Construction app\\src\\components\\ui\\sonner.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\gemini antigravity works\\Construction app\\src\\components\\ui\\table.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\gemini antigravity works\\Construction app\\src\\components\\ui\\tabs.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\gemini antigravity works\\Construction app\\src\\components\\ui\\textarea.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\gemini antigravity works\\Construction app\\src\\components\\ui\\tooltip.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\gemini antigravity works\\Construction app\\src\\components\\worker-delete-button.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\gemini antigravity works\\Construction app\\src\\components\\worker-dialog.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\gemini antigravity works\\Construction app\\src\\hooks\\use-mobile.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\gemini antigravity works\\Construction app\\src\\lib\\canvasUtils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\gemini antigravity works\\Construction app\\src\\lib\\prisma.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\gemini antigravity works\\Construction app\\src\\lib\\session.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'SessionPayload' is defined but never used.","line":8,"column":6,"nodeType":null,"messageId":"unusedVar","endLine":8,"endColumn":20},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":56,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":56,"endColumn":19}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import \"server-only\";\r\nimport { SignJWT, jwtVerify } from \"jose\";\r\nimport { cookies } from \"next/headers\";\r\n\r\nconst secretKey = process.env.SESSION_SECRET;\r\nconst encodedKey = new TextEncoder().encode(secretKey || \"default-secret-key-change-me\");\r\n\r\ntype SessionPayload = {\r\n    userId: number;\r\n    role: string;\r\n    expiresAt: Date;\r\n};\r\n\r\nexport async function createSession(userId: number, role: string) {\r\n    const expiresAt = new Date(Date.now() + 7 * 24 * 60 * 60 * 1000);\r\n    const session = await new SignJWT({ userId, role, expiresAt })\r\n        .setProtectedHeader({ alg: \"HS256\" })\r\n        .setIssuedAt()\r\n        .setExpirationTime(\"7d\")\r\n        .sign(encodedKey);\r\n\r\n    const cookieStore = await cookies();\r\n\r\n    cookieStore.set(\"session\", session, {\r\n        httpOnly: true,\r\n        secure: process.env.NODE_ENV === \"production\",\r\n        expires: expiresAt,\r\n        sameSite: \"lax\",\r\n        path: \"/\",\r\n    });\r\n}\r\n\r\nexport async function deleteSession() {\r\n    const cookieStore = await cookies();\r\n    cookieStore.delete(\"session\");\r\n}\r\n\r\nexport async function verifySession() {\r\n    const cookieStore = await cookies();\r\n    const cookie = cookieStore.get(\"session\")?.value;\r\n    const session = await decrypt(cookie);\r\n\r\n    if (!session?.userId) {\r\n        return null;\r\n    }\r\n\r\n    return { isAuth: true, userId: session.userId as number, role: session.role as string };\r\n}\r\n\r\nexport async function decrypt(session: string | undefined = \"\") {\r\n    try {\r\n        const { payload } = await jwtVerify(session, encodedKey, {\r\n            algorithms: [\"HS256\"],\r\n        });\r\n        return payload;\r\n    } catch (error) {\r\n        console.log(\"Failed to verify session\");\r\n        return null;\r\n    }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\gemini antigravity works\\Construction app\\src\\lib\\utils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\gemini antigravity works\\Construction app\\src\\proxy.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]}]
